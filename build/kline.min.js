!function(t,i){if("object"===typeof exports&&"object"===typeof module)module.exports=i();else if("function"===typeof define&&define.amd)define([],i);else{var e=i();for(var s in e)("object"===typeof exports?exports:t)[s]=e[s]}}(window,function(){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)e.d(s,a,function(i){return t[i]}.bind(null,a));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="/",e(e.s=0)}([function(t,i,e){t.exports=e(1)},function(t,i,e){"use strict";e.r(i);var s=class{constructor(){this.contentRect={left:0,right:0,top:0,bottom:0},this.viewHeight=0,this.viewWidth=0}setChartDimens(t,i){this.viewWidth=t,this.viewHeight=i,this.restrainViewPort(this.contentLeft(),this.contentTop(),t-this.contentRight(),i-this.contentBottom())}restrainViewPort(t,i,e,s){this.contentRect.left=t,this.contentRect.right=this.viewWidth-e,this.contentRect.top=i,this.contentRect.bottom=this.viewHeight-s}contentTop(){return this.contentRect.top}contentLeft(){return this.contentRect.left}contentRight(){return this.contentRect.right}contentBottom(){return this.contentRect.bottom}getContentCenter(){let t={};return t.x=(this.contentRect.left+this.contentRect.right)/2,t.y=(this.contentRect.top+this.contentRect.bottom)/2,t}isInBoundsX(t){return this.isInBoundsLeft(t)&&this.isInBoundsRight(t)}isInBoundsLeft(t){return this.contentRect.left<=t+1}isInBoundsRight(t){let i=parseInt(100*t)/100;return this.contentRect.right>=i-1}};var a=class{constructor(t){this.viewPortHandler=t,this.dataList=[],this.min=0,this.range=120,this.maxRange=180,this.minRange=20,this.dataSpace=0,this.dataMarginSpaceRate=.2,this.currentDataPos=0}space(){this.dataSpace=(this.viewPortHandler.contentRight()-this.viewPortHandler.contentLeft())/this.range}moveToLast(){this.dataList.length>this.range?(this.min=this.dataList.length-this.range,this.currentDataPos=this.dataList.length-1):this.min=0}calcCurrentDataIndex(t){let i=+Math.ceil(t/this.dataSpace).toFixed(0);this.currentDataPos=this.min+i-1}};var o=class{constructor(t,i){this.dataBounds=t,this.viewPortHandler=i,this.chartTop=0,this.chartHeight=0}setChartDimens(t,i){this.chartHeight=t,this.chartTop=i}getY(t,i,e){return this.chartTop+(1-(t-i)/e)*this.chartHeight}};var h=class extends o{constructor(t,i,e){super(i,e),this.grid=t}draw(t){this.grid.display&&(t.strokeStyle=this.grid.lineColor,t.lineWidth=this.grid.lineSize,t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentTop()),t.lineTo(this.viewPortHandler.contentRight(),this.viewPortHandler.contentTop()),t.lineTo(this.viewPortHandler.contentRight(),this.viewPortHandler.contentBottom()),t.lineTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentBottom()),t.lineTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentTop()),t.stroke(),t.closePath())}};var r={canvas:document.createElement("canvas").getContext("2d"),formatDate(t){let i=new Date(t),e=(i.getMonth()+1).toString(),s=i.getDate().toString(),a=i.getHours().toString(),o=i.getMinutes().toString();return(1===e.length?"0"+e:e)+"-"+(1===s.length?"0"+s:s)+" "+(1===a.length?"0"+a:a)+":"+(1===o.length?"0"+o:o)},calcTextWidth(t,i){return this.canvas.font=t,this.canvas.measureText(i).width},nice(t){let i=Math.floor(Math.log(t)/Math.log(10)),e=Math.pow(10,i),s=t/e,a=0;return t=(a=s<1?1:s<2?2:s<3?3:s<5?5:10)*e,i>=-20?+t.toFixed(i<0?-i:0):t},getIntervalPrecision(t){let i=t.toString(),e=i.indexOf("e");if(e>0){let t=+i.slice(e+1);return t<0?-t:0}{let t=i.indexOf(".");return t<0?0:i.length-1-t}},round:(t,i)=>(null==i&&(i=10),i=Math.min(Math.max(0,i),20),t=(+t).toFixed(i))};var n=class extends o{constructor(t,i){super(t,i),this.values=[],this.valueCount=0}computeAxisValues(t,i){let e=i-t;if(e<0)return this.values=[],void(this.valueCount=0);let s=+r.nice(e/5),a=r.getIntervalPrecision(s),o=+r.round(Math.ceil(t/s)*s,a),h=+r.round(Math.floor(i/s)*s,a),n=0,l=o;if(0!==s)for(;l<=+h;)++n,l+=s;this.valueCount=n,this.values=[];let d=0;for(l=o;d<n;)this.values[d]=l,l+=s,++d}};const l={NO:"NO",MA:"MA",VOL:"VOL",MACD:"MACD",BOLL:"BOLL",KDJ:"KDJ",KD:"KD",RSI:"RSI",BIAS:"BIAS",BRAR:"BRAR",CCI:"CCI",DMI:"DMI",CR:"CR",PSY:"PSY",DMA:"DMA",TRIX:"TRIX",OBV:"OBV",VR:"VR",WR:"WR",MTM:"MTM",EMV:"EMV",SAR:"SAR"};var d=class{constructor(){this.lineSize=1,this.increasingColor="#5DB300",this.decreasingColor="#FF4A4A",this.lineColors=["#898989","#F5A623","#F601FF","#1587DD","#50A300"]}};const c={DASH:"dash",SOLID:"solid"};var u=class{constructor(){this.display=!0,this.color="#707070",this.axisLine={display:!0,color:"#707070",size:1},this.tickText={display:!0,position:m.OUTSIDE,color:"#707070",size:12,margin:3,valueFormatter:null},this.tickLine={display:!0,size:3,color:"#707070"},this.separatorLine={display:!1,size:1,color:"#B8B8B8",style:c.DASH,dashValue:[8,8]}}};const x={LEFT:"left",RIGHT:"right"},m={OUTSIDE:"outside",INSIDE:"inside"};var g=class extends u{constructor(){super(),this.yAxisPosition=x.RIGHT,this.yAxisMaxWidth=80,this.yAxisMinWidth=40}needsOffset(){return((this.tickText.display||this.tickLine.display||this.tickText.margin>0)&&this.tickText.position===m.OUTSIDE||this.axisLine.display)&&this.display}getRequiredWidthSpace(){let t=0;if(this.tickText.position===m.OUTSIDE&&(t+=r.calcTextWidth(2*this.tickText.size,"0000000")+2*this.tickText.margin,this.display&&this.tickLine.display&&(t+=2*this.tickLine.size)),this.display&&this.axisLine.display&&(t+=this.axisLine.size),t===this.axisLine.size)return t;let i=t;return i>0&&(i=2*this.yAxisMaxWidth,t=Math.min(i,Math.max(t,2*this.yAxisMinWidth))),t}};var p=class extends n{constructor(t,i,e){super(i,e),this.axisMaximum=0,this.axisMinimum=0,this.axisRange=0,this.yAxis=t}drawAxisLine(t){this.yAxis.display&&this.yAxis.axisLine.display&&(t.strokeStyle=this.yAxis.axisLine.color||this.yAxis.color,t.lineWidth=this.yAxis.axisLine.size,t.beginPath(),this.yAxis.yAxisPosition===x.LEFT?(t.moveTo(this.viewPortHandler.contentLeft(),this.chartTop),t.lineTo(this.viewPortHandler.contentLeft(),this.chartTop+this.chartHeight)):(t.moveTo(this.viewPortHandler.contentRight(),this.chartTop),t.lineTo(this.viewPortHandler.contentRight(),this.chartTop+this.chartHeight)),t.stroke(),t.closePath())}drawAxisLabels(t){if(!this.yAxis.display||!this.yAxis.tickText.display)return;let i;i=this.yAxis.yAxisPosition===x.LEFT?this.yAxis.tickText.position===m.OUTSIDE?this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentLeft()-2*this.yAxis.tickLine.size-2*this.yAxis.tickText.margin:this.viewPortHandler.contentLeft()-2*this.yAxis.tickText.margin:this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentLeft()+2*this.yAxis.tickLine.size+2*this.yAxis.tickText.margin:this.viewPortHandler.contentLeft()+2*this.yAxis.tickText.margin:this.yAxis.tickText.position===m.OUTSIDE?this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentRight()+2*this.yAxis.tickLine.size+2*this.yAxis.tickText.margin:this.viewPortHandler.contentRight()+2*this.yAxis.tickText.margin:this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentRight()-2*this.yAxis.tickLine.size-2*this.yAxis.tickText.margin:this.viewPortHandler.contentRight()-2*this.yAxis.tickText.margin,t.font=2*this.yAxis.tickText.size+"px Arial",t.fillStyle=this.yAxis.tickText.color||this.yAxis.color;let e=2*this.yAxis.tickText.size,s=e/2,a=this.yAxis.tickText.valueFormatter;for(let o=0;o<this.values.length;o++){let h=this.getValueY(this.values[o]),r=this.values[o].toString();if(a&&(r=a(this.values[o])||"--"),this.checkShowLabel(h,e)){this.yAxis.yAxisPosition===x.LEFT&&this.yAxis.tickText.position===m.OUTSIDE||this.yAxis.yAxisPosition===x.RIGHT&&this.yAxis.tickText.position!==m.OUTSIDE?t.textAlign="right":t.textAlign="left";let e=h+s;t.fillText(r,i,e)}}t.textAlign="left"}drawSeparatorLines(t){if(!this.yAxis.display||!this.yAxis.separatorLine.display)return;t.strokeStyle=this.yAxis.separatorLine.color||this.yAxis.color,t.lineWidth=this.yAxis.separatorLine.size;let i=2*this.yAxis.tickText.size;this.xAxis.separatorLine.style===c.DASH&&t.setLineDash(this.xAxis.separatorLine.dashValue);for(let e=0;e<this.values.length;e++){let s=this.getValueY(this.values[e]);this.checkShowLabel(s,i)&&(t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),s),t.lineTo(this.viewPortHandler.contentRight(),s),t.stroke(),t.closePath())}t.setLineDash([])}drawTickLines(t){if(!this.yAxis.display||!this.yAxis.tickLine.display)return;t.lineWidth=1,t.strokeStyle=this.yAxis.axisLine.color||this.yAxis.color;let i,e,s=2*this.yAxis.tickText.size;this.yAxis.yAxisPosition===x.LEFT?(i=this.viewPortHandler.contentLeft(),e=this.yAxis.tickText.position===m.OUTSIDE?i-2*this.yAxis.tickLine.size:i+2*this.yAxis.tickLine.size):(i=this.viewPortHandler.contentRight(),e=this.yAxis.tickText.position===m.OUTSIDE?i+2*this.yAxis.tickLine.size:i-2*this.yAxis.tickLine.size);for(let a=0;a<this.values.length;a++){let o=this.getValueY(this.values[a]);this.checkShowLabel(o,s)&&(t.beginPath(),t.moveTo(i,o),t.lineTo(e,o),t.stroke(),t.closePath())}}checkShowLabel(t,i){return t>this.chartTop+i&&t<this.chartTop+this.chartHeight-i}getYAxisDataMinMax(t,i=!1,e=!1){let s=this.dataBounds.dataList,a=this.dataBounds.min,o=Math.min(a+this.dataBounds.range,s.length),h=[Number.MAX_VALUE,Number.MIN_VALUE];if(e)for(let r=a;r<o;r++){let t=s[r];h[0]=Math.min(t.averagePrice,h[0]),h[0]=Math.min(t.close,h[0]),h[1]=Math.max(t.averagePrice,h[1]),h[1]=Math.max(t.close,h[1])}else for(let r=a;r<o;r++){let e=s[r];this.calcIndexMinMax(e,t,h),i&&(h[0]=Math.min(e.low,h[0]),h[1]=Math.max(e.high,h[1]))}h[0]!==Number.MAX_VALUE&&h[1]!==Number.MIN_VALUE&&(this.axisMinimum=h[0],this.axisMaximum=h[1],this.computeAxis())}calcIndexMinMax(t,i,e){switch(i){case l.MA:e[0]=Math.min(t.ma.ma5,e[0]),e[0]=Math.min(t.ma.ma10,e[0]),e[0]=Math.min(t.ma.ma20,e[0]),e[0]=Math.min(t.ma.ma60,e[0]),e[1]=Math.max(t.ma.ma5,e[1]),e[1]=Math.max(t.ma.ma10,e[1]),e[1]=Math.max(t.ma.ma20,e[1]),e[1]=Math.max(t.ma.ma60,e[1]);break;case l.MACD:e[0]=Math.min(t.macd.dea,e[0]),e[0]=Math.min(t.macd.diff,e[0]),e[0]=Math.min(t.macd.macd,e[0]),e[1]=Math.max(t.macd.dea,e[1]),e[1]=Math.max(t.macd.diff,e[1]),e[1]=Math.max(t.macd.macd,e[1]);break;case l.VOL:e[0]=Math.min(t.vol.ma5,0),e[0]=Math.min(t.vol.ma10,0),e[0]=Math.min(t.vol.ma20,0),e[0]=Math.min(t.vol.num,0),e[1]=Math.max(t.vol.ma5,e[1]),e[1]=Math.max(t.vol.ma10,e[1]),e[1]=Math.max(t.vol.ma20,e[1]),e[1]=Math.max(t.vol.num,e[1]);break;case l.BOLL:e[0]=Math.min(t.boll.up,e[0]),e[0]=Math.min(t.boll.mid,e[0]),e[0]=Math.min(t.boll.dn,e[0]),e[0]=Math.min(t.low,e[0]),e[1]=Math.max(t.boll.up,e[1]),e[1]=Math.max(t.boll.mid,e[1]),e[1]=Math.max(t.boll.dn,e[1]),e[1]=Math.max(t.high,e[1]);break;case l.BIAS:e[0]=Math.min(t.bias.bias1,e[0]),e[0]=Math.min(t.bias.bias2,e[0]),e[0]=Math.min(t.bias.bias3,e[0]),e[1]=Math.max(t.bias.bias1,e[1]),e[1]=Math.max(t.bias.bias2,e[1]),e[1]=Math.max(t.bias.bias3,e[1]);break;case l.BRAR:e[0]=Math.min(t.brar.br,e[0]),e[0]=Math.min(t.brar.ar,e[0]),e[1]=Math.max(t.brar.br,e[1]),e[1]=Math.max(t.brar.ar,e[1]);break;case l.CCI:e[0]=Math.min(t.cci.cci,e[0]),e[1]=Math.max(t.cci.cci,e[1]);break;case l.CR:e[0]=Math.min(t.cr.cr,e[0]),e[0]=Math.min(t.cr.ma1,e[0]),e[0]=Math.min(t.cr.ma2,e[0]),e[0]=Math.min(t.cr.ma3,e[0]),e[0]=Math.min(t.cr.ma4,e[0]),e[1]=Math.max(t.cr.cr,e[1]),e[1]=Math.max(t.cr.ma1,e[1]),e[1]=Math.max(t.cr.ma2,e[1]),e[1]=Math.max(t.cr.ma3,e[1]),e[1]=Math.max(t.cr.ma4,e[1]);break;case l.DMA:e[0]=Math.min(t.dma.dif,e[0]),e[0]=Math.min(t.dma.difMa,e[0]),e[1]=Math.max(t.dma.dif,e[1]),e[1]=Math.max(t.dma.difMa,e[1]);break;case l.DMI:e[0]=Math.min(t.dmi.pdi,e[0]),e[0]=Math.min(t.dmi.mdi,e[0]),e[0]=Math.min(t.dmi.adx,e[0]),e[0]=Math.min(t.dmi.adxr,e[0]),e[1]=Math.max(t.dmi.pdi,e[1]),e[1]=Math.max(t.dmi.mdi,e[1]),e[1]=Math.max(t.dmi.adx,e[1]),e[1]=Math.max(t.dmi.adxr,e[1]);break;case l.KDJ:e[0]=Math.min(t.kdj.k,e[0]),e[0]=Math.min(t.kdj.d,e[0]),e[0]=Math.min(t.kdj.j,e[0]),e[1]=Math.max(t.kdj.k,e[1]),e[1]=Math.max(t.kdj.d,e[1]),e[1]=Math.max(t.kdj.j,e[1]);break;case l.KD:e[0]=Math.min(t.kdj.k,e[0]),e[0]=Math.min(t.kdj.d,e[0]),e[1]=Math.max(t.kdj.k,e[1]),e[1]=Math.max(t.kdj.d,e[1]);break;case l.RSI:e[0]=Math.min(t.rsi.rsi1,e[0]),e[0]=Math.min(t.rsi.rsi2,e[0]),e[0]=Math.min(t.rsi.rsi3,e[0]),e[1]=Math.max(t.rsi.rsi1,e[1]),e[1]=Math.max(t.rsi.rsi2,e[1]),e[1]=Math.max(t.rsi.rsi3,e[1]);break;case l.PSY:e[0]=Math.min(t.psy.psy,e[0]),e[1]=Math.max(t.psy.psy,e[1]);break;case l.TRIX:e[0]=Math.min(t.trix.trix,e[0]),e[0]=Math.min(t.trix.maTrix,e[0]),e[1]=Math.max(t.trix.trix,e[1]),e[1]=Math.max(t.trix.maTrix,e[1]);break;case l.OBV:e[0]=Math.min(t.obv.obv,e[0]),e[0]=Math.min(t.obv.maObv,e[0]),e[1]=Math.max(t.obv.obv,e[1]),e[1]=Math.max(t.obv.maObv,e[1]);break;case l.VR:e[0]=Math.min(t.vr.vr,e[0]),e[0]=Math.min(t.vr.maVr,e[0]),e[1]=Math.max(t.vr.vr,e[1]),e[1]=Math.max(t.vr.maVr,e[1]);break;case l.WR:e[0]=Math.min(t.wr.wr1,e[0]),e[0]=Math.min(t.wr.wr2,e[0]),e[0]=Math.min(t.wr.wr3,e[0]),e[1]=Math.max(t.wr.wr1,e[1]),e[1]=Math.max(t.wr.wr2,e[1]),e[1]=Math.max(t.wr.wr3,e[1]);break;case l.MTM:e[0]=Math.min(t.mtm.mtm,e[0]),e[0]=Math.min(t.mtm.mtmMa,e[0]),e[1]=Math.max(t.mtm.mtm,e[1]),e[1]=Math.max(t.mtm.mtmMa,e[1]);break;case l.EMV:e[0]=Math.min(t.emv.emv,e[0]),e[0]=Math.min(t.emv.maEmv,e[0]),e[1]=Math.max(t.emv.emv,e[1]),e[1]=Math.max(t.emv.maEmv,e[1]);break;case l.SAR:e[0]=Math.min(t.sar.sar,e[0]),e[1]=Math.max(t.sar.sar,e[1]),e[0]=Math.min(t.low,e[0]),e[1]=Math.max(t.high,e[1])}return e}computeAxis(){let t=this.axisMinimum,i=this.axisMaximum,e=Math.abs(i-t);0===e&&(i+=1,t-=1,e=Math.abs(i-t)),this.axisMinimum=t-e/100*10,this.axisMaximum=i+e/100*20,this.axisRange=Math.abs(this.axisMaximum-this.axisMinimum),this.computeAxisValues(this.axisMinimum,this.axisMaximum)}getValueY(t){return this.getY(t,this.axisMinimum,this.axisRange)}};var v=class extends o{constructor(t,i,e,s,a,o=l.MACD){super(s,a),this.indicator=t,this.xAxis=i,this.yAxisChart=new p(e,s,a),this.indicatorType=o}setChartDimens(t,i){super.setChartDimens(t,i),this.yAxisChart.setChartDimens(t,i)}draw(t){this.drawChartHorizontalSeparatorLine(t),this.yAxisChart.getYAxisDataMinMax(this.indicatorType),this.yAxisChart.drawSeparatorLines(t),this.yAxisChart.drawTickLines(t),this.drawIndicator(t),this.yAxisChart.drawAxisLine(t),this.yAxisChart.drawAxisLabels(t)}drawChartHorizontalSeparatorLine(t){t.lineWidth=this.xAxis.axisLine.size,t.strokeStyle=this.xAxis.axisLine.color,t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),this.chartTop),t.lineTo(this.viewPortHandler.contentRight(),this.chartTop),t.closePath(),t.stroke()}drawIndicator(t,i=!1){switch(this.indicatorType){case l.MA:this.drawLines(t,"ma",["ma5","ma10","ma20","ma60"]);break;case l.MACD:this.drawBarLines(t,"macd","macd",["diff","dea"],(i,e,s)=>{let a=(i.macd||{}).macd,o=((e||{}).macd||{}).macd;a>0?(t.strokeStyle=this.indicator.increasingColor,t.fillStyle=this.indicator.increasingColor):(t.strokeStyle=this.indicator.decreasingColor,t.fillStyle=this.indicator.decreasingColor),(o||0===o)&&a>o?t.strokeRect(s[0],s[1],s[2]-s[0],s[3]-s[1]):t.fillRect(s[0],s[1],s[2]-s[0],s[3]-s[1])});break;case l.VOL:this.drawBarLines(t,"vol","num",["ma5","ma10","ma20"],(i,e,s)=>{let a=i.close,o=(e||{}).close;t.fillStyle=(o||0===o)&&a>o?this.indicator.increasingColor:this.indicator.decreasingColor,t.fillRect(s[0],s[1],s[2]-s[0],s[3]-s[1])});break;case l.BOLL:this.drawLines(t,"boll",["up","mid","dn"],(e,s)=>{let a=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate)/2;this.drawOhlc(t,a,e,s,i)});break;case l.BIAS:this.drawLines(t,"bias",["bias1","bias2","bias3"]);break;case l.BRAR:this.drawLines(t,"brar",["br","ar"]);break;case l.CCI:this.drawLines(t,"cci",["cci"]);break;case l.CR:this.drawLines(t,"cr",["cr","ma1","ma2","ma3","ma4"]);break;case l.DMA:this.drawLines(t,"dma",["dif","difMa"]);break;case l.DMI:this.drawLines(t,"dmi",["mdi","pdi","adx","adxr"]);break;case l.KDJ:this.drawLines(t,"kdj",["k","d","j"]);break;case l.KD:this.drawLines(t,"kd",["k","d"]);break;case l.RSI:this.drawLines(t,"rsi",["rsi1","rsi2","rsi3"]);break;case l.PSY:this.drawLines(t,"psy",["psy"]);break;case l.TRIX:this.drawLines(t,"trix",["trix","maTrix"]);break;case l.OBV:this.drawLines(t,"obv",["obv","maObv"]);break;case l.VR:this.drawLines(t,"vr",["vr","maVr"]);break;case l.WR:this.drawLines(t,"wr",["wr1","wr2","wr3"]);break;case l.MTM:this.drawLines(t,"mtm",["mtm","mtmMa"]);break;case l.EMV:this.drawLines(t,"emv",["emv","maEmv"]);break;case l.SAR:this.drawSar(t,i)}}drawSar(t,i){t.save(),t.beginPath(),t.rect(this.viewPortHandler.contentLeft(),this.chartTop,this.viewPortHandler.contentRight()-this.viewPortHandler.contentLeft(),this.viewPortHandler.contentBottom()-this.chartTop),t.closePath(),t.clip(),t.lineWidth=1;let e=this.viewPortHandler.contentLeft(),s=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),a=s/2,o=this.dataBounds.min;for(;o<this.dataBounds.dataList.length&&o<this.dataBounds.min+this.dataBounds.range;){let h=(e+(e+s))/2,r=this.dataBounds.dataList[o];this.drawOhlc(t,a,h,r,i);let n=r.sar.sar;if(n||0===n){let i=this.getValueY(n);n<(r.high+r.low)/2?t.strokeStyle=this.indicator.increasingColor:t.strokeStyle=this.indicator.decreasingColor,t.beginPath(),t.arc(h,i,a,2*Math.PI,0,!0),t.stroke(),t.closePath()}e+=this.dataBounds.dataSpace,++o}t.restore()}drawBarLines(t,i,e,s,a){let o=this.viewPortHandler.contentLeft(),h=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),r=h/2,n=this.dataBounds.min,l=[],d=[];for(;n<this.dataBounds.dataList.length&&n<this.dataBounds.min+this.dataBounds.range;){let t,c=(o+(o+h))/2,u=this.dataBounds.dataList[n];n>0&&(t=this.dataBounds.dataList[n-1]);let x=u[i],m=x[e];if(m||0===m){l[0]=c-r,l[2]=c+r;let i=this.getValueY(m),e=this.getValueY(0);l[1]=i,l[3]=e,a(u,t,l)}for(let i=0;i<s.length;i++){let t=x[s[i]],e=this.getValueY(t);d[i]?d[i].push({x:c,y:e}):d[i]=[{x:c,y:e}]}o+=this.dataBounds.dataSpace,++n}this.drawLine(t,d)}drawLines(t,i,e,s){let a=this.viewPortHandler.contentLeft(),o=this.dataBounds.min,h=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),r=[];for(;o<this.dataBounds.dataList.length&&o<this.dataBounds.min+this.dataBounds.range;){let t=(a+(a+h))/2,n=this.dataBounds.dataList[o];s&&s(t,n);let l=n[i];for(let i=0;i<e.length;i++){let s=l[e[i]],a=this.getValueY(s);r[i]?r[i].push({x:t,y:a}):r[i]=[{x:t,y:a}]}a+=this.dataBounds.dataSpace,++o}this.drawLine(t,r)}drawLine(t,i){for(let e=0;e<i.length;e++){let s=i[e];if(s.length>0){t.strokeStyle=this.indicator.lineColors[e],t.beginPath(),t.moveTo(s[0].x,s[0].y);for(let i=1;i<s.length;i++)t.lineTo(s[i].x,s[i].y);t.stroke(),t.closePath()}}}drawOhlc(t,i,e,s,a){if(!a){let a=this.getValueY(s.open),o=this.getValueY(s.close),h=this.getValueY(s.high),r=this.getValueY(s.low);s.close>s.open?t.strokeStyle=this.indicator.increasingColor:t.strokeStyle=this.indicator.decreasingColor,this.drawOhlcLines(t,i,e,a,o,h,r)}}drawOhlcLines(t,i,e,s,a,o,h){t.beginPath(),t.moveTo(e,o),t.lineTo(e,h),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(e-i,s),t.lineTo(e,s),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(e+i,a),t.lineTo(e,a),t.stroke(),t.closePath()}getValueY(t){return this.getY(t,this.yAxisChart.axisMinimum,this.yAxisChart.axisRange)}isDisplayChart(){return this.indicatorType!==l.NO}};const L={SOLID:"solid",STROKE:"stroke",INCREASING_STROKE:"increasing_stroke",DECREASING_STROKE:"decreasing_stroke",OHLC:"ohlc"},M={CANDLE:"candle",TIME_LINE:"time_line"};var y=class{constructor(){this.chartStyle=M.CANDLE,this.timeChart={timeLineSize:1,timeLineColor:"#D8D8D8",timeLineFillColor:"#f4f4f4",timeAverageLineColor:"#F5A623"},this.candleChart={candleStyle:L.SOLID,increasingColor:"#5DB300",decreasingColor:"#FF4A4A"},this.lowestHighestPriceMarkTextColor="#898989",this.lowestHighestPriceMarkTextSize=10,this.lowestHighestValueFormatter=null,this.highestPriceMark={display:!0,color:"#898989",textSize:10,valueFormatter:null},this.lowestPriceMark={display:!0,color:"#898989",textSize:10,valueFormatter:null},this.lastPriceMark={display:!0,lineStyle:c.DASH,dashValue:[8,8],lineSize:1,lineColor:"#B9B9B9"}}};var f=class extends v{constructor(t,i,e,s,a){super(i,null,e,s,a),this.candle=t,this.indicatorType=l.MA,this.highestMarkData={},this.lowestMarkData={}}draw(t){let i=this.candle.chartStyle===M.TIME_LINE;this.yAxisChart.getYAxisDataMinMax(this.indicatorType,!0,i),this.yAxisChart.drawSeparatorLines(t),this.yAxisChart.drawTickLines(t),i?this.drawTimeLine(t):(this.drawCandle(t),this.drawIndicator(t,!0),this.drawHighestPriceMark(t),this.drawLowestPriceMark(t)),this.drawLastPriceMark(t),this.yAxisChart.drawAxisLine(t),this.yAxisChart.drawAxisLabels(t)}drawCandle(t){t.lineWidth=1;let i=this.dataBounds.dataList,e=this.viewPortHandler.contentLeft(),s=this.dataBounds.min,a=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),o=a/2,h=[],r=Number.MIN_VALUE,n=-1,l=Number.MAX_VALUE,d=-1;for(;s<i.length&&s<this.dataBounds.min+this.dataBounds.range;){let c=e+a,u=(e+c)/2,x=i[s],m=x.high,g=x.low;r<m&&(r=m,n=u),g<l&&(l=g,d=u);let p=this.getValueY(x.open),v=this.getValueY(x.close),M=this.getValueY(m),y=this.getValueY(g);if(x.close>x.open?(t.strokeStyle=this.candle.candleChart.increasingColor,t.fillStyle=this.candle.candleChart.increasingColor):(t.strokeStyle=this.candle.candleChart.decreasingColor,t.fillStyle=this.candle.candleChart.decreasingColor),this.candle.candleChart.candleStyle!==L.OHLC){let i=[],s=[];switch(p>v?(i[0]=M,i[1]=v,s[0]=p,s[1]=y,h=[e,v,c-e,p-v]):p<v?(i[0]=M,i[1]=p,s[0]=v,s[1]=y,h=[e,p,c-e,v-p]):(i[0]=M,i[1]=p,s[0]=v,s[1]=y,h=[e,p,c-e,1]),t.beginPath(),t.moveTo(u,i[0]),t.lineTo(u,i[1]),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(u,s[0]),t.lineTo(u,s[1]),t.stroke(),t.closePath(),this.candle.candleChart.candleStyle){case L.SOLID:t.fillRect(h[0],h[1],h[2],h[3]);break;case L.STROKE:t.strokeRect(h[0],h[1],h[2],h[3]);break;case L.INCREASING_STROKE:x.close>x.open?t.strokeRect(h[0],h[1],h[2],h[3]):t.fillRect(h[0],h[1],h[2],h[3]);break;case L.DECREASING_STROKE:x.close>x.open?t.fillRect(h[0],h[1],h[2],h[3]):t.strokeRect(h[0],h[1],h[2],h[3])}}else this.drawOhlcLines(t,o,u,p,v,M,y);e+=this.dataBounds.dataSpace,++s}this.highestMarkData={x:n,price:r},this.lowestMarkData={x:d,price:l}}drawHighestPriceMark(t){let i=this.highestMarkData.price;if(i===Number.MIN_VALUE||!this.candle.highestPriceMark.display)return;let e=this.candle.highestPriceMark.color||this.candle.lowestHighestPriceMarkTextColor,s=this.candle.highestPriceMark.textSize||this.candle.lowestHighestPriceMarkTextSize,a=this.candle.highestPriceMark.valueFormatter||this.candle.lowestHighestValueFormatter;this.drawLowestHighestPriceMark(t,this.highestMarkData.x,i,e,s,a,!0)}drawLowestPriceMark(t){let i=this.lowestMarkData.price;if(i===Number.MAX_VALUE||!this.candle.lowestPriceMark.display)return;let e=this.candle.lowestPriceMark.color||this.candle.lowestHighestPriceMarkTextColor,s=this.candle.lowestPriceMark.textSize||this.candle.lowestHighestPriceMarkTextSize,a=this.candle.lowestPriceMark.valueFormatter||this.candle.lowestHighestValueFormatter;this.drawLowestHighestPriceMark(t,this.lowestMarkData.x,i,e,s,a)}drawLowestHighestPriceMark(t,i,e,s,a,o,h=!1){t.save(),t.beginPath(),t.rect(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentTop(),this.viewPortHandler.contentRight()-this.viewPortHandler.contentLeft(),this.chartTop+this.chartHeight),t.closePath(),t.clip();let r=this.getValueY(e),n=i,l=r+(h?-4:4);t.textAlign="left",t.lineWidth=1,t.strokeStyle=s,t.fillStyle=s,t.beginPath(),t.moveTo(n,l),t.lineTo(n-4,l+(h?-4:4)),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(n,l),t.lineTo(n+4,l+(h?-4:4)),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(n,l),l+=h?-10:10,t.lineTo(n,l),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(n,l),t.lineTo(n+10,l),t.stroke(),t.closePath(),t.font=2*a+"px Arial";let d=e.toFixed(2);o&&(d=o(e)+""),t.fillText(d,n+14,r+(h?-a:2*a)),t.restore()}drawLastPriceMark(t){if(!this.candle.lastPriceMark.display||0===this.dataBounds.dataList.length)return;let i=this.dataBounds.dataList[this.dataBounds.dataList.length-1].close,e=this.getValueY(i);e=Math.max(this.chartTop+.05*this.chartHeight,Math.min(e,this.chartTop+.98*this.chartHeight)),t.strokeStyle=this.candle.lastPriceMark.lineColor,t.lineWidth=this.candle.lastPriceMark.lineSize,this.candle.lastPriceMark.lineStyle===c.DASH&&t.setLineDash(this.candle.lastPriceMark.dashValue),t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),e),t.lineTo(this.viewPortHandler.contentRight(),e),t.stroke(),t.closePath(),t.setLineDash([])}drawTimeLine(t){let i=[],e=[{x:this.viewPortHandler.contentLeft(),y:this.chartTop+this.chartHeight}],s=[];t.lineWidth=this.candle.timeChart.timeLineSize;let a=this.dataBounds.dataList,o=this.viewPortHandler.contentLeft(),h=this.dataBounds.min,r=this.dataBounds.dataSpace-this.dataBounds.dataMarginSpaceRate*this.dataBounds.dataSpace;for(;h<this.dataBounds.dataList.length&&h<this.dataBounds.min+this.dataBounds.range;){let t=(o+(o+r))/2,n=a[h],l=this.getValueY(n.close),d=this.getValueY(n.averagePrice);i.push({x:t,y:l}),n.averagePrice&&s.push({x:t,y:d}),h===this.dataBounds.min?(e.push({x:this.viewPortHandler.contentLeft(),y:l}),e.push({x:t,y:l})):h===this.dataBounds.min+this.dataBounds.range-1?(e.push({x:t,y:l}),e.push({x:this.viewPortHandler.contentRight(),y:l}),e.push({x:this.viewPortHandler.contentRight(),y:this.chartHeight+this.chartTop})):h===this.dataBounds.dataList.length-1?(e.push({x:t,y:l}),e.push({x:t,y:this.chartTop+this.chartHeight})):e.push({x:t,y:l}),o+=this.dataBounds.dataSpace,++h}if(i.length>0){t.strokeStyle=this.candle.timeChart.timeLineColor,t.beginPath(),t.moveTo(i[0].x,i[0].y);for(let e=1;e<i.length;e++)t.lineTo(i[e].x,i[e].y);t.stroke(),t.closePath()}if(e.length>0){t.fillStyle=this.candle.timeChart.timeLineFillColor,t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fill()}if(s.length>0){t.strokeStyle=this.candle.timeChart.timeAverageLineColor,t.beginPath(),t.moveTo(s[0].x,s[0].y);for(let i=1;i<s.length;i++)t.lineTo(s[i].x,s[i].y);t.stroke(),t.closePath()}}};var P=class extends n{constructor(t,i,e){super(i,e),this.xAxis=t}draw(t){this.computeAxis(),this.drawAxisLine(t),this.drawTickLines(t),this.drawAxisLabels(t),this.drawSeparatorLines(t)}drawAxisLine(t){this.xAxis.display&&this.xAxis.axisLine.display&&(t.strokeStyle=this.xAxis.axisLine.color||this.xAxis.color,t.lineWidth=this.xAxis.axisLine.size,t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentBottom()),t.lineTo(this.viewPortHandler.contentRight(),this.viewPortHandler.contentBottom()),t.stroke(),t.closePath())}drawAxisLabels(t){if(!this.xAxis.display||!this.xAxis.tickText.display)return;t.font=2*this.xAxis.tickText.size+"px Arial",t.textAlign="center",t.fillStyle=this.xAxis.tickText.color||this.xAxis.color;let i=this.pointValuesToPixel(),e=2*this.xAxis.tickText.size,s=this.viewPortHandler.contentBottom()+2*this.xAxis.tickText.margin+e;this.display&&this.xAxis.tickLine.display&&(s+=2*this.xAxis.tickLine.size);let a=this.xAxis.tickText.valueFormatter;for(let o=0;o<i.length;o+=2){let e=i[o];if(this.viewPortHandler.isInBoundsX(e)){let i=this.dataBounds.dataList[parseInt(this.values[o/2])],h=i.timestamp,n=r.formatDate(h);a&&(n=a(i)),t.fillText(n,e,s)}}}drawSeparatorLines(t){if(!this.xAxis.display||!this.xAxis.separatorLine.display)return;t.strokeStyle=this.xAxis.separatorLine.color||this.xAxis.color,t.lineWidth=this.xAxis.separatorLine.size,this.xAxis.separatorLine.style===c.DASH&&t.setLineDash(this.xAxis.separatorLine.dashValue);let i=this.pointValuesToPixel();for(let e=0;e<i.length;e+=2){let s=i[e];this.viewPortHandler.isInBoundsX(s)&&(t.beginPath(),t.moveTo(s,this.viewPortHandler.contentTop()),t.lineTo(s,this.viewPortHandler.contentBottom()),t.stroke(),t.closePath())}t.setLineDash([])}drawTickLines(t){if(!this.xAxis.display||!this.xAxis.tickLine.display)return;t.lineWidth=1,t.strokeStyle=this.xAxis.axisLine.color||this.xAxis.color;let i=this.pointValuesToPixel(),e=this.viewPortHandler.contentBottom(),s=e+2*this.xAxis.tickLine.size;for(let a=0;a<i.length;a+=2){let o=i[a];this.viewPortHandler.isInBoundsX(o)&&(t.beginPath(),t.moveTo(o,e),t.lineTo(o,s),t.stroke(),t.closePath())}}pointValuesToPixel(){let t=[];for(let i=0;i<2*this.valueCount;i+=2){let e=this.values[i/2];t[i]=(e-this.dataBounds.min)*this.dataBounds.dataSpace+this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate)/2}return t}computeAxis(){let t=this.dataBounds.min,i=Math.min(t+this.dataBounds.range-1,this.dataBounds.dataList.length-1);this.computeAxisValues(t,i)}};const A={ALWAYS:"always",FOLLOW_CROSS:"follow_cross",NONE:"none"};var k=class{constructor(){this.textSize=12,this.crossLine={style:c.SOLID,dashValue:[8,8],size:1,color:"#505050",text:{color:"#EDEDED",size:12,rectStrokeLineSize:1,rectStrokeLineColor:"#EDEDED",rectFillColor:"#505050",margin:4,valueFormatter:null}},this.generalData={labels:["\u65f6\u95f4","\u5f00","\u6536","\u9ad8","\u4f4e"],values:null,valueFormatter:null,text:{size:12,color:"#898989",margin:20}},this.indicatorData={displayRule:A.ALWAYS,valueFormatter:null,text:{size:12,margin:20}}}};var w=class extends o{constructor(t,i,e,s,a,o,h,r,n){super(r,n),this.displayCross=!1,this.crossPoint={x:0,y:0},this.tooltip=t,this.candle=i,this.indicator=e,this.yAxis=s,this.candleChart=a,this.volChart=o,this.indicatorChart=h,this.yAxisLabelStrokePathPoints=[]}draw(t){if(this.dataBounds.currentDataPos<this.dataBounds.dataList.length){let i=this.dataBounds.dataList[this.dataBounds.currentDataPos];if(this.displayCross&&(this.crossPoint.x=this.viewPortHandler.contentLeft()+this.dataBounds.dataSpace*(this.dataBounds.currentDataPos-this.dataBounds.min)+this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate)/2,t.font=2*(this.tooltip.crossLine.text.size||this.tooltip.textSize)+"px Arial",this.drawCrossHorizontalLine(t),this.drawCrossVerticalLine(t,i)),this.tooltip.indicatorData.displayRule===A.ALWAYS||this.tooltip.indicatorData.displayRule===A.FOLLOW_CROSS&&this.displayCross){let e=2*(this.tooltip.indicatorData.text.size||this.tooltip.textSize),s=this.viewPortHandler.contentLeft()+10;t.font=e+"px Arial",this.drawGeneralDataTooltip(t,s,i),this.candle.chartStyle!==M.TIME_LINE&&this.drawIndicatorTooltip(t,s,this.candleChart.chartTop+10+e+10+2*(this.tooltip.generalData.text.size||this.tooltip.textSize),i,this.candleChart.indicatorType),this.drawIndicatorTooltip(t,s,this.volChart.chartTop+4+e,i,this.volChart.indicatorType),this.drawIndicatorTooltip(t,s,this.indicatorChart.chartTop+4+e,i,this.indicatorChart.indicatorType)}}}drawCrossHorizontalLine(t){let i=this.getCrossYAxisLabel();if(null==i)return;let e,s=this.yAxis.tickText.position===m.OUTSIDE,a=this.tooltip.crossLine.text.size||this.tooltip.textSize,o=r.calcTextWidth(2*a+"px Arial",i),h=a,n=this.crossPoint.y+h,l=this.viewPortHandler.contentLeft(),d=this.viewPortHandler.contentRight(),u=this.viewPortHandler.getContentCenter(),g=this.tooltip.crossLine.text.margin,p=this.tooltip.crossLine.text.rectStrokeLineSize;s?e=this.yAxis.yAxisPosition===x.LEFT?l-p-2*g-o:d+p+2*g:this.crossPoint.x>u.x?(l=this.viewPortHandler.contentLeft()+2*p+3*g+o,e=this.viewPortHandler.contentLeft()+p+g):e=(d=this.viewPortHandler.contentRight()-2*p-3*g-o)+p+2*g,!s&&this.crossPoint.x>u.x||s&&this.yAxis.yAxisPosition===x.LEFT?(this.yAxisLabelStrokePathPoints[0]={x:l,y:this.crossPoint.y},this.yAxisLabelStrokePathPoints[1]={x:l-g,y:this.crossPoint.y-h-g},this.yAxisLabelStrokePathPoints[2]={x:l-3*g-o,y:this.yAxisLabelStrokePathPoints[1].y},this.yAxisLabelStrokePathPoints[3]={x:this.yAxisLabelStrokePathPoints[2].x,y:this.crossPoint.y+h+g},this.yAxisLabelStrokePathPoints[4]={x:this.yAxisLabelStrokePathPoints[1].x,y:this.yAxisLabelStrokePathPoints[3].y}):(this.yAxisLabelStrokePathPoints[0]={x:d,y:this.crossPoint.y},this.yAxisLabelStrokePathPoints[1]={x:d+g,y:this.crossPoint.y-h-g},this.yAxisLabelStrokePathPoints[2]={x:d+3*g+o,y:this.yAxisLabelStrokePathPoints[1].y},this.yAxisLabelStrokePathPoints[3]={x:this.yAxisLabelStrokePathPoints[2].x,y:this.crossPoint.y+h+g},this.yAxisLabelStrokePathPoints[4]={x:this.yAxisLabelStrokePathPoints[1].x,y:this.yAxisLabelStrokePathPoints[3].y}),t.lineWidth=this.tooltip.crossLine.size,t.strokeStyle=this.tooltip.crossLine.color,this.tooltip.crossLine.style===c.DASH&&t.setLineDash(this.tooltip.crossLine.dashValue),t.beginPath(),t.moveTo(l,this.crossPoint.y),t.lineTo(d,this.crossPoint.y),t.stroke(),t.closePath(),t.setLineDash([]),t.fillStyle=this.tooltip.crossLine.rectFillColor,t.beginPath(),t.moveTo(this.yAxisLabelStrokePathPoints[0].x,this.yAxisLabelStrokePathPoints[0].y);for(let r=1;r<this.yAxisLabelStrokePathPoints.length;r++)t.lineTo(this.yAxisLabelStrokePathPoints[r].x,this.yAxisLabelStrokePathPoints[r].y);t.closePath(),t.fill(),t.lineWidth=this.tooltip.crossLine.rectStrokeLineSize,t.strokeStyle=this.tooltip.crossLine.rectStrokeLineColor,t.beginPath(),t.moveTo(this.yAxisLabelStrokePathPoints[0].x,this.yAxisLabelStrokePathPoints[0].y);for(let r=1;r<this.yAxisLabelStrokePathPoints.length;r++)t.lineTo(this.yAxisLabelStrokePathPoints[r].x,this.yAxisLabelStrokePathPoints[r].y);t.closePath(),t.stroke(),t.fillStyle=this.tooltip.crossLine.text.color,t.fillText(i,e,n)}getCrossYAxisLabel(){let t=this.candleChart.yAxisChart,i=t.chartHeight,e=t.chartTop,s=this.volChart.yAxisChart,a=s.chartHeight,o=s.chartTop,h=this.indicatorChart.yAxisChart,r=h.chartHeight,n=h.chartTop,d=this.crossPoint.y;if(d>e&&d<i+e){let s=t.axisMinimum,a=(1-(d-e)/i)*(t.axisMaximum-s)+s,o=a.toFixed(2);return this.tooltip.crossLine.text.valueFormatter&&(o=this.tooltip.crossLine.text.valueFormatter("y",a)||"--"),o}if(d>o&&d<o+a){let t=s.axisMinimum,i=(1-(d-o)/a)*(s.axisMaximum-t)+t,e=i.toFixed(0);return this.tooltip.crossLine.text.valueFormatter&&(e=this.tooltip.crossLine.text.valueFormatter("y",i)||"--"),e}if(d>n&&d<n+r){let t=h.axisMinimum,i=(1-(d-n)/r)*(h.axisMaximum-t)+t,e=i.toFixed(2);return this.indicatorChart.indicatorType===l.VOL&&(e=i.toFixed(0)),this.tooltip.crossLine.text.valueFormatter&&(e=this.tooltip.crossLine.text.valueFormatter("y",i)||"--"),e}return null}drawCrossVerticalLine(t,i){t.lineWidth=this.tooltip.crossLine.size,t.strokeStyle=this.tooltip.crossLine.color,this.tooltip.crossLine.style===c.DASH&&t.setLineDash(this.tooltip.crossLine.dashValue),t.beginPath(),t.moveTo(this.crossPoint.x,this.viewPortHandler.contentTop()),t.lineTo(this.crossPoint.x,this.viewPortHandler.contentBottom()),t.stroke(),t.closePath(),t.setLineDash([]);let e=i.timestamp,s=r.formatDate(e);this.tooltip.crossLine.text.valueFormatter&&(s=this.tooltip.crossLine.text.valueFormatter("x",i)||"--");let a=this.tooltip.crossLine.text.size||this.tooltip.textSize,o=r.calcTextWidth(2*a+"px Arial",s),h=this.crossPoint.x-o/2,n=this.tooltip.crossLine.text.margin,l=this.tooltip.crossLine.text.rectStrokeLineSize;h<this.viewPortHandler.contentLeft()+n+l?h=this.viewPortHandler.contentLeft():h>this.viewPortHandler.contentRight()-o-l&&(h=this.viewPortHandler.contentRight()-o-l);let d=h-l-n,u=this.viewPortHandler.contentBottom(),x=h+o+n+l,m=this.viewPortHandler.contentBottom()+2*a+l+2*n;t.fillStyle=this.tooltip.crossLine.text.rectFillColor,t.fillRect(d,u,x-d,m-u),t.lineWidth=l,t.strokeStyle=this.tooltip.crossLine.rectStrokeLineColor,t.strokeRect(d,u,x-d,m-u),t.fillStyle=this.tooltip.crossLine.text.color,t.fillText(s,h,this.viewPortHandler.contentBottom()+2*a+l+n)}drawGeneralDataTooltip(t,i,e){let s=this.tooltip.generalData.text.size||this.tooltip.textSize;t.font=2*s+"px Arial";let a=this.tooltip.generalData.text.color,o=[];if(this.tooltip.generalData.values)o=this.tooltip.generalData.values(e)||[];else{let t=this.tooltip.generalData.valueFormatter,i=r.formatDate(e.timestamp),s=e.open.toFixed(2),a=e.close.toFixed(2),h=e.high.toFixed(2),n=e.low.toFixed(2);t&&(i=t(0,e.timestamp)||"--",s=t(1,e.open)||"--",a=t(2,e.close)||"--",h=t(3,e.high)||"--",n=t(4,e.low)||"--"),o=[i,s,a,h,n]}let h=this.tooltip.generalData.labels;for(let n=0;n<h.length;n++){let e=(h[n]||"--")+": ",l=r.calcTextWidth(2*s+"px Arial",e);t.fillStyle=a,t.fillText(e,i,2*s+4),i+=l;let d,c=o[n]||"--";"object"===typeof c?(d=c.value||"--",t.fillStyle=c.color||a):(t.fillStyle=a,d=c);let u=r.calcTextWidth(2*s+"px Arial",d);t.fillText(d,i,2*s+4),i+=u+this.tooltip.generalData.text.margin}}drawIndicatorTooltip(t,i,e,s,a){switch(a){case l.MA:{let a=s.ma;this.drawIndicatorTooltipLabels(t,i,e,[a.ma5,a.ma10,a.ma20,a.ma60],["MA5","MA10","MA20","MA60"],s,l.MA);break}case l.MACD:{let a=s.macd;this.drawIndicatorTooltipLabels(t,i,e,[a.diff,a.dea,a.macd],["DIFF","DEA","MACD"],s,l.MACD);break}case l.VOL:{let a=s.vol;this.drawIndicatorTooltipLabels(t,i,e,[a.ma5,a.ma10,a.ma20,a.num],["MA5","MA10","MA20","VOLUME"],s,l.VOL);break}case l.BOLL:{let a=s.boll;this.drawIndicatorTooltipLabels(t,i,e,[a.up,a.mid,a.dn],["UP","MID","DN"],s,l.BOLL);break}case l.BIAS:{let a=s.bias;this.drawIndicatorTooltipLabels(t,i,e,[a.bias1,a.bias2,a.bias3],["BIAS6","BIAS12","BIAS24"],s,l.BIAS);break}case l.BRAR:{let a=s.brar;this.drawIndicatorTooltipLabels(t,i,e,[a.br,a.ar],["BR","AR"],s,l.BRAR);break}case l.CCI:{let a=s.cci;this.drawIndicatorTooltipLabels(t,i,e,[a.cci],["CCI"],s,l.CCI);break}case l.CR:{let a=s.cr;this.drawIndicatorTooltipLabels(t,i,e,[a.cr,a.ma1,a.ma2,a.ma3,a.ma4],["CR","MA1","MA2","MA3","MA4"],s,l.CR);break}case l.DMA:{let a=s.dma;this.drawIndicatorTooltipLabels(t,i,e,[a.dif,a.difMa],["DIF","DIFMA"],s,l.DMA);break}case l.DMI:{let a=s.dmi;this.drawIndicatorTooltipLabels(t,i,e,[a.mdi,a.pdi,a.adx,a.adxr],["MDI","PDI","ADX","ADXR"],s,l.DMI);break}case l.KDJ:{let a=s.kdj;this.drawIndicatorTooltipLabels(t,i,e,[a.k,a.d,a.j],["K","D","J"],s,l.KDJ);break}case l.KD:{let a=s.kdj;this.drawIndicatorTooltipLabels(t,i,e,[a.k,a.d],["K","D"],s,l.KDJ);break}case l.RSI:{let a=s.rsi;this.drawIndicatorTooltipLabels(t,i,e,[a.rsi1,a.rsi2,a.rsi3],["RSI6","RSI12","RSI24"],s,l.RSI);break}case l.PSY:{let a=s.psy;this.drawIndicatorTooltipLabels(t,i,e,[a.psy],["PSY"],s,l.PSY);break}case l.TRIX:{let a=s.trix;this.drawIndicatorTooltipLabels(t,i,e,[a.trix,a.maTrix],["TRIX","MATRIX"],s,l.TRIX);break}case l.OBV:{let a=s.obv;this.drawIndicatorTooltipLabels(t,i,e,[a.obv,a.maObv],["OBV","MAOBV"],s,l.OBV);break}case l.VR:{let a=s.vr;this.drawIndicatorTooltipLabels(t,i,e,[a.vr,a.maVr],["VR","MAVR"],s,l.VR);break}case l.WR:{let a=s.wr;this.drawIndicatorTooltipLabels(t,i,e,[a.wr1,a.wr2,a.wr3],["WR1","WR2","WR3"],s,l.WR);break}case l.MTM:{let a=s.mtm;this.drawIndicatorTooltipLabels(t,i,e,[a.mtm,a.mtmMa],["MTM","MTMMA"],s,l.MTM);break}case l.EMV:{let a=s.emv;this.drawIndicatorTooltipLabels(t,i,e,[a.emv,a.maEmv],["EMV","MAEMV"],s,l.EMV);break}case l.SAR:{let a=s.sar;this.drawIndicatorTooltipLabels(t,i,e,[a.sar],["SAR"],s,l.SAR);break}}}drawIndicatorTooltipLabels(t,i,e,s,a,o,h){let n=i;for(let d=0;d<s.length;d++){let i=s[d],o="--";(i||0===i)&&(o=h===l.VOL?i.toFixed(0):i.toFixed(2)),this.tooltip.indicatorData.valueFormatter&&(o=this.tooltip.indicatorData.valueFormatter(h,i)||"--");let c=a[d]+": "+o,u=r.calcTextWidth(2*(this.tooltip.indicatorData.text.size||this.tooltip.textSize)+"px Arial",c);t.fillStyle=this.indicator.lineColors[d],t.fillText(c,n,e),n+=this.tooltip.indicatorData.text.margin+u}}setCross(t,i){this.crossPoint.y=t,this.displayCross=i}};var T=class extends u{constructor(){super(),this.xAxisMaxHeight=20,this.xAxisMinHeight=20}getRequiredHeightSpace(){let t=2*this.tickText.size+2*this.tickText.margin;this.display&&this.tickLine.display&&(t+=2*this.tickLine.size),this.display&&this.axisLine.display&&(t+=this.axisLine.size);let i=t;return this.xAxisMaxHeight>0&&(i=2*this.xAxisMaxHeight),t=Math.max(2*this.xAxisMinHeight,Math.min(t,i))}};var b=class{constructor(){this.display=!0,this.lineSize=1,this.lineColor="#707070"}};var C=class{constructor(t,i,e){this.kline=t,this.dataBounds=i,this.viewPortHandler=e}isValidEvent(t){return!(t.x<this.viewPortHandler.contentLeft()||t.x>this.viewPortHandler.contentRight()||t.y<this.viewPortHandler.contentTop()||t.y>this.viewPortHandler.contentBottom())}};const S="cross",B="drag";var D=class extends C{constructor(t,i,e){super(t,i,e),this.mouseMode=S,this.mouseDownPoint={x:0,y:0}}mouseDown(t){let i=this.getCanvasPoint(t);this.isValidEvent(i)&&(this.mouseMode=B,this.mouseDownPoint.x=t.x,this.mouseDownPoint.y=t.y,this.kline.tooltipChart.setCross(i.y,!1),this.kline.freshen())}mouseUp(t){let i=this.getCanvasPoint(t);this.isValidEvent(i)&&(this.mouseMode=S,this.kline.tooltipChart.setCross(i.y,!0),this.kline.freshen())}mouseLeave(t){let i=this.getCanvasPoint(t);this.kline.tooltipChart.setCross(i.y,!1),this.kline.freshen()}mouseMove(t){let i=this.getCanvasPoint(t);if(!this.isValidEvent(i))return this.kline.tooltipChart.setCross(i.y,!1),void this.kline.freshen();if(this.mouseMode===B){let i=t.x-this.mouseDownPoint.x;if(i>this.dataBounds.dataSpace/2){if(0===this.dataBounds.min||this.dataBounds.dataList.length<this.dataBounds.range)return!1;this.mouseDownPoint.x=t.x;let e=+Math.abs(i/this.dataBounds.dataSpace).toFixed(0);0===e&&(e=1),this.dataBounds.min-=e,this.dataBounds.min<=0&&(this.dataBounds.min=0),this.kline.freshen()}else if(i<0-this.dataBounds.dataSpace/2){if(this.dataBounds.min+this.dataBounds.range===this.dataBounds.dataList.length||this.dataBounds.dataList.length<this.dataBounds.range)return!1;this.mouseDownPoint.x=t.x;let e=+Math.abs(i/this.dataBounds.dataSpace).toFixed(0);0===e&&(e=1),this.dataBounds.min+=e,this.dataBounds.min>=this.dataBounds.dataList.length-this.dataBounds.range&&(this.dataBounds.min=this.dataBounds.dataList.length-this.dataBounds.range),this.kline.freshen()}}else this.mouseMode===S&&(this.dataBounds.calcCurrentDataIndex(i.x),this.kline.tooltipChart.setCross(i.y,!0),this.kline.freshen())}mouseWheel(t){let i=this.dataBounds.min,e=this.dataBounds.range,s=1;if(1===Math.max(-1,Math.min(1,t.wheelDelta||-t.detail))){if(s=.95,this.dataBounds.range>=this.dataBounds.maxRange)return!1}else if(s=1.05,this.dataBounds.range<=this.dataBounds.minRange)return!1;this.dataBounds.range=+(e/s).toFixed(0),this.dataBounds.range=Math.min(Math.max(this.dataBounds.range,this.dataBounds.minRange),this.dataBounds.maxRange),this.dataBounds.min=i+e-this.dataBounds.range,this.dataBounds.min+this.dataBounds.range>this.dataBounds.dataList.length&&(this.dataBounds.min=0),this.dataBounds.min<0&&(this.dataBounds.min=0),this.kline.freshen()}getCanvasPoint(t){let i=this.kline.canvasDom.getBoundingClientRect();return{x:2*Math.round(t.clientX-i.left),y:2*Math.round(t.clientY-i.top)}}};const R=0,H=1,I=2,V=3,E=4,O=5;var z=class extends C{constructor(t,i,e){super(t,i,e),this.touchMode=R,this.touchStartPoint={x:0,y:0},this.touchMovePoint={x:0,y:0},this.touchCrossPoint={x:0,y:0},this.savedDist=1,this.savedXDist=1,this.touchRange=this.dataBounds.range,this.touchStartPosition=this.dataBounds.min,this.delayTimeout=null,this.delayActiveCross=(()=>{this.touchMode!==R&&this.touchMode!==O||this.kline&&(this.touchMode=E,this.touchCrossPoint={x:this.touchStartPoint.x,y:this.touchStartPoint.y},i.calcCurrentDataIndex(this.touchCrossPoint.x),this.kline.tooltipChart.setCross(this.touchCrossPoint.y,!0),this.kline.freshen())})}touchStart(t){if(1===t.targetTouches.length){if(this.touchStartPoint={x:2*t.targetTouches[0].clientX,y:2*t.targetTouches[0].clientY},this.touchMovePoint={x:2*t.targetTouches[0].clientX,y:2*t.targetTouches[0].clientY},!this.isValidEvent(this.touchStartPoint))return;this.touchMode===E?(t.preventDefault(),this.distance(2*t.targetTouches[0].clientX,this.touchCrossPoint.x,2*t.targetTouches[0].clientY,this.touchCrossPoint.y)<10?this.performCross(t):(this.touchMode=O,this.kline.tooltipChart.setCross(0,!1),this.kline.freshen())):this.touchMode=R,this.removeDelayActiveCross(),this.postDelayDelayActiveCross()}else if(t.targetTouches.length>1){if(!this.isValidEvent(this.touchStartPoint))return;this.touchMode!==E&&(t.preventDefault(),this.savedDist=this.spacing(t),this.savedXDist=this.getXDist(t),this.savedDist>3&&(this.touchMode=I),this.touchRange=this.dataBounds.range,this.touchStartPosition=this.dataBounds.min)}}touchMove(t){if(this.isValidEvent(this.touchStartPoint))switch(this.touchMode){case I:t.preventDefault(),this.performZoom(t);break;case H:t.preventDefault(),this.performDrag(t);break;case E:t.preventDefault(),this.performCross(t);break;case O:this.removeDelayActiveCross();break;case R:if(Math.abs(this.distance(2*t.targetTouches[0].clientX,this.touchStartPoint.x,2*t.targetTouches[0].clientY,this.touchStartPoint.y))>10){let i=Math.abs(2*t.targetTouches[0].clientX-this.touchStartPoint.x);Math.abs(2*t.targetTouches[0].clientY-this.touchStartPoint.y)<=i&&(t.preventDefault(),this.kline.tooltipChart.setCross(0,!1),this.touchMode=H,this.kline.freshen())}this.removeDelayActiveCross()}}touchEnd(t){this.isValidEvent(this.touchStartPoint)&&(t.targetTouches.length>0?this.touchMode===E?this.performCross(t):this.touchMode=V:(this.removeDelayActiveCross(),this.touchMode!==E&&(this.touchMode=R,this.kline.tooltipChart.setCross(0,!1),this.kline.freshen())))}performDrag(t){let i=2*t.targetTouches[0].clientX-this.touchMovePoint.x;if(i<0-this.dataBounds.dataSpace/2){if(this.dataBounds.min+this.dataBounds.range===this.dataBounds.dataList.length||this.dataBounds.dataList.length<this.dataBounds.range)return!1;this.touchMovePoint.x=2*t.targetTouches[0].clientX;let e=+Math.abs(i/this.dataBounds.dataSpace).toFixed(0);0===e&&(e=1),this.dataBounds.min+=e,this.dataBounds.min>=this.dataBounds.dataList.length-this.dataBounds.range&&(this.dataBounds.min=this.dataBounds.dataList.length-this.dataBounds.range),this.kline.freshen()}else if(i>this.dataBounds.dataSpace/2){if(0===this.dataBounds.min||this.dataBounds.dataList.length<this.dataBounds.range)return!1;this.touchMovePoint.x=2*t.targetTouches[0].clientX;let e=+Math.abs(i/this.dataBounds.dataSpace).toFixed(0);0===e&&(e=1),this.dataBounds.min-=e,this.dataBounds.min<=0&&(this.dataBounds.min=0),this.kline.freshen()}}performZoom(t){if(t.targetTouches.length>1&&this.spacing(t)>10){let i=this.getXDist(t)/this.savedXDist;if(i<1){if(this.dataBounds.range>=this.dataBounds.maxRange)return!1}else if(this.dataBounds.range<=this.dataBounds.minRange)return!1;this.dataBounds.range=+(this.touchRange/i).toFixed(0),this.dataBounds.range=Math.min(Math.max(this.dataBounds.range,this.dataBounds.minRange),this.dataBounds.maxRange),this.dataBounds.min=this.touchStartPosition+this.touchRange-this.dataBounds.range,this.dataBounds.min+this.dataBounds.range>this.dataBounds.dataList.length&&(this.dataBounds.min=0),this.dataBounds.min<0&&(this.dataBounds.min=0),this.kline.freshen()}}performCross(t){this.touchCrossPoint={x:2*t.targetTouches[0].clientX,y:2*t.targetTouches[0].clientY},this.dataBounds.calcCurrentDataIndex(this.touchCrossPoint.x),this.kline.tooltipChart.setCross(this.touchCrossPoint.y,!0),this.kline.freshen()}postDelayDelayActiveCross(){this.delayTimeout=setTimeout(this.delayActiveCross,200)}removeDelayActiveCross(){this.delayTimeout&&(clearTimeout(this.delayTimeout),this.delayTimeout=null)}distance(t,i,e,s){let a=t-i,o=e-s;return Math.sqrt(a*a+o*o)}spacing(t){if(t.targetTouches.length<2)return 0;let i=Math.abs(2*t.targetTouches[0].clientX-2*t.targetTouches[1].clientX),e=Math.abs(2*t.targetTouches[0].clientY-2*t.targetTouches[1].clientY);return Math.sqrt(i*i+e*e)}getXDist(t){return Math.abs(2*t.targetTouches[0].clientX-2*t.targetTouches[1].clientX)}};function F(t){let i,e,s,a,o,h=0,r=0;for(let n=0;n<t.length;n++){h+=t[n].turnover,0!==(r+=t[n].volume)&&(t[n].averagePrice=h/r);let l=t[n].close;n<8?(a=N(t.slice(0,n+1)),o=Y(t.slice(0,n+1))):(a=N(t.slice(n-8,n+1)),o=Y(t.slice(n-8,n+1)));let d=(l-a)/(o-a===0?1:o-a)*100;s=3*(i=2/3*(n<8?50:t[n-1].kdj.k)+1/3*d)-2*(e=2/3*(n<8?50:t[n-1].kdj.d)+1/3*i),t[n].kdj={k:i,d:e,j:s}}return t}function W(t,i){let e=0;for(let o=0;o<t.length;o++){let s=t[o].close-i;e+=s*s}let s=e>0;e=Math.abs(e);let a=Math.sqrt(e/t.length);return s?a:-1*a}function Y(t){let i=0;if(t&&t.length>0){let e=t.length;i=t[0].high;for(let s=1;s<e;s++)i=Math.max(t[s].high,i)}return i}function N(t){let i=0;if(t&&t.length>0){let e=t.length;i=t[0].low;for(let s=1;s<e;s++)i=Math.min(t[s].low,i)}return i}const X=/Android|webOS|iPhone|iPod|BlackBerry|UCBrowser/i.test(navigator.userAgent);var _=class{constructor(t){this.rootDom=t,this.domWidth=0,this.domHeight=0,this.canvas=null,this.canvasDom=null,this.viewPortHandler=new s,this.dataBounds=new a(this.viewPortHandler),this.grid=new b,this.yAxis=new g,this.xAxis=new T,this.candle=new y,this.indicator=new d,this.tooltip=new k,this.gridChart=new h(this.grid,this.dataBounds,this.viewPortHandler),this.candleChart=new f(this.candle,this.indicator,this.yAxis,this.dataBounds,this.viewPortHandler),this.volChart=new v(this.indicator,this.xAxis,this.yAxis,this.dataBounds,this.viewPortHandler,l.VOL),this.indicatorChart=new v(this.indicator,this.xAxis,this.yAxis,this.dataBounds,this.viewPortHandler),this.xAxisChart=new P(this.xAxis,this.dataBounds,this.viewPortHandler),this.tooltipChart=new w(this.tooltip,this.candle,this.indicator,this.yAxis,this.candleChart,this.volChart,this.indicatorChart,this.dataBounds,this.viewPortHandler),this.motionEvent=X?new z(this,this.dataBounds,this.viewPortHandler):new D(this,this.dataBounds,this.viewPortHandler),this.isShouldCalcOffset=!0,this.isShouldCalcChartHeight=!0,this.init()}init(){this.canvasDom=document.createElement("canvas");try{X?(this.canvasDom.addEventListener("touchstart",t=>{this.motionEvent.touchStart(t)},!1),this.canvasDom.addEventListener("touchmove",t=>{this.motionEvent.touchMove(t)},!1),this.canvasDom.addEventListener("touchend",t=>{this.motionEvent.touchEnd(t)},!1)):(this.canvasDom.addEventListener("mousedown",t=>{this.motionEvent.mouseDown(t)}),this.canvasDom.addEventListener("mouseup",t=>{this.motionEvent.mouseUp(t)}),this.canvasDom.addEventListener("mousemove",t=>{this.motionEvent.mouseMove(t)}),this.canvasDom.addEventListener("mouseleave",t=>{this.motionEvent.mouseLeave(t)}),this.canvasDom.addEventListener("mousewheel",t=>{this.motionEvent.mouseWheel(t)},!1),this.canvasDom.addEventListener("DOMMouseScroll",t=>{this.motionEvent.mouseWheel(t)},!1))}catch(t){}this.rootDom.appendChild(this.canvasDom),this.resize()}resize(){this.isShouldCalcOffset=!0,this.domWidth=2*this.rootDom.offsetWidth,this.domHeight=2*this.rootDom.offsetHeight,this.canvasDom.style.width=this.rootDom.offsetWidth+"px",this.canvasDom.style.height=this.rootDom.offsetHeight+"px",this.freshen()}setConfig(t){if(t){let i=t.common;i&&(i.minVisibleRange>0&&(this.dataBounds.minRange=i.minVisibleRange),i.maxVisibleRange>0&&i.maxVisibleRange>this.dataBounds.minRange&&(this.dataBounds.maxRange=i.maxVisibleRange),i.defaultVisibleRange>0&&i.defaultVisibleRange>this.dataBounds.minRange-1&&i.defaultVisibleRange<this.dataBounds.maxRange+1&&(this.dataBounds.range=i.defaultVisibleRange));let e=t.grid;e&&(this.grid.display=e.display,e.lineSize>0&&(this.grid.lineSize=e.lineSize),e.lineColor&&(this.grid.lineColor=e.lineColor));let s=i.candle;s&&(s.chartType&&(this.candle.chartStyle=s.chartType),s.timeChart&&(this.candle.timeChart={...this.candle.timeChart,...s.timeChart}),s.candleChart&&(this.candle.candleChart={...this.candle.candleChart,...s.candleChart}),s.lowestHighestPriceMarkTextColor&&(this.candle.lowestHighestPriceMarkTextColor=s.lowestHighestPriceMarkTextColor),s.lowestHighestPriceMarkTextSize>0&&(this.candle.lowestHighestPriceMarkTextSize=s.lowestHighestPriceMarkTextSize),this.candle.lowestHighestValueFormatter=s.lowestHighestValueFormatter,s.highestPriceMark&&(this.candle.highestPriceMark={...this.candle.highestPriceMark,...s.highestPriceMark}),s.lowestPriceMark&&(this.candle.lowestPriceMark={...this.candle.lowestPriceMark,...s.lowestPriceMark}),s.lastPriceMark&&(this.candle.lastPriceMark={...this.candle.lastPriceMark,...s.lastPriceMark}));let a=t.indicator;a&&(a.lineSize>0&&(this.indicator.lineSize=a.lineSize),a.increasingColor&&(this.indicator.increasingColor=a.increasingColor),a.decreasingColor&&(this.indicator.decreasingColor=a.decreasingColor),a.lineColors&&a.lineColors.length>4&&(this.indicator.lineColors=a.lineColors));let o=t.xAxis;o&&(this.xAxis.display=o.display,this.xAxis.color&&(this.xAxis.color=o.color),o.minHeight>=0&&(this.xAxis.xAxisMinHeight=o.minHeight),o.maxHeight>=0&&o.maxHeight>=this.xAxis.xAxisMinHeight&&(this.xAxis.xAxisMaxHeight=o.maxHeight),o.axisLine&&(this.xAxis.axisLine={...this.xAxis.axisLine,...o.axisLine}),o.tickText&&(this.xAxis.tickText={...this.xAxis.tickText,...o.tickText}),o.tickLine&&(this.xAxis.tickLine={...this.xAxis.tickLine,...o.tickLine}),o.separatorLine&&(this.xAxis.separatorLine={...this.xAxis.separatorLine,...o.separatorLine}));let h=t.yAxis;h&&(this.yAxis.display=h.display,h.position&&(this.yAxis.yAxisPosition=h.position,this.isShouldCalcOffset=!0),this.yAxis.color&&(this.yAxis.color=h.color),h.minWidth>=0&&(this.yAxis.yAxisMinWidth=h.minWidth),h.maxWidth>=0&&h.maxWidth>=this.yAxis.yAxisMinWidth&&(this.yAxis.yAxisMaxWidth=h.maxWidth),h.axisLine&&(this.yAxis.axisLine={...this.yAxis.axisLine,...h.axisLine}),h.tickText&&(this.yAxis.tickText={...this.yAxis.tickText,...h.tickText},this.isShouldCalcOffset=!0),h.tickLine&&(this.yAxis.tickLine={...this.yAxis.tickLine,...h.tickLine}),h.separatorLine&&(this.yAxis.separatorLine={...this.yAxis.separatorLine,...h.separatorLine}));let r=t.tooltip;r&&(r.textSize>0&&(this.tooltip.textSize=r.textSize),r.crossLine&&(r.crossLine.text&&(r.crossLine.text={...this.tooltip.crossLine.text,...r.crossLine.text}),this.tooltip.crossLine={...this.tooltip.crossLine,...r.crossLine}),r.generalData&&(r.generalData.text&&(r.generalData.text={...this.tooltip.generalData.text,...r.generalData.text}),this.tooltip.generalData={...this.tooltip.generalData,...r.generalData}),r.indicatorData&&(r.indicatorData.text&&(r.indicatorData.text={...this.tooltip.indicatorData.text,...r.indicatorData.text}),this.tooltip.indicatorData={...this.tooltip.indicatorData,...r.indicatorData})),this.freshen()}}calcChartHeight(t){let i=this.xAxis.getRequiredHeightSpace(),e=t-i,s=this.isDisplayVolChart(),a=this.isDisplayIndicatorChart(),o=0,h=0;if(s&&a){let t=.2*e;o=t,h=t}else s&&!a?o=.3*e:!s&&a&&(h=.3*e);let r=e-o-h,n=0;this.candleChart.setChartDimens(r,n),n+=r,this.volChart.setChartDimens(o,n),n+=o,this.indicatorChart.setChartDimens(h,n),n+=h,this.xAxisChart.setChartDimens(i,n)}calcOffsets(){let t=0,i=0,e=0;if(this.yAxis.needsOffset()){let e=this.yAxis.getRequiredWidthSpace();this.yAxis.yAxisPosition===x.LEFT?t+=e:i+=e}e+=this.xAxis.getRequiredHeightSpace(),this.viewPortHandler.restrainViewPort(t,0,i,e)}freshen(){this.canvasDom.width=this.domWidth,this.canvasDom.height=this.domHeight,this.canvas=this.canvasDom.getContext("2d"),this.isShouldCalcChartHeight&&(this.calcChartHeight(this.domHeight),this.isShouldCalcChartHeight=!1),this.isShouldCalcOffset&&(this.viewPortHandler.setChartDimens(this.domWidth,this.domHeight),this.calcOffsets(),this.isShouldCalcOffset=!1),this.draw()}draw(){this.dataBounds.space(),this.gridChart.draw(this.canvas),this.xAxisChart.draw(this.canvas),this.candleChart.draw(this.canvas),this.volChart.draw(this.canvas),this.indicatorChart.draw(this.canvas),this.tooltipChart.draw(this.canvas)}calcIndicator(t){switch(t){case l.MA:this.dataBounds.dataList=function(t){let i,e,s,a,o=0,h=0,r=0,n=0,l=0,d=0;for(let c=0;c<t.length;c++){d+=t[c].volume,l+=t[c].turnover||0,0!==d&&(t[c].averagePrice=l/d);let u=t[c].close;o+=u,h+=u,r+=u,n+=u,i=c<5?o/(c+1):(o-=t[c-5].close)/5,e=c<10?h/(c+1):(h-=t[c-10].close)/10,s=c<20?r/(c+1):(r-=t[c-20].close)/20,a=c<60?n/(c+1):(n-=t[c-60].close)/60,t[c].ma={ma5:i,ma10:e,ma20:s,ma60:a}}return t}(this.dataBounds.dataList);break;case l.MACD:this.dataBounds.dataList=function(t){let i,e,s=0,a=0,o=0,h=0,r=0,n=0,l=0,d=0;for(let c=0;c<t.length;c++){l+=t[c].turnover,0!==(d+=t[c].volume)&&(t[c].averagePrice=l/d);let u=t[c].close;c>0&&(n=2*((o=(i=(2*u+11*s)/13)-(e=(2*u+25*a)/27))-(h=(2*o+8*r)/10)),s=i,a=e,r=h),t[c].macd={diff:o,dea:h,macd:n}}return t}(this.dataBounds.dataList);break;case l.VOL:this.dataBounds.dataList=function(t){let i,e,s,a=0,o=0,h=0,r=0,n=0;for(let l=0;l<t.length;l++){r+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=r/n);let d=t[l].volume;a+=d,o+=d,h+=d,i=l<5?a/(l+1):(a-=t[l-5].volume)/5,e=l<10?o/(l+1):(o-=t[l-10].volume)/10,s=l<20?h/(l+1):(h-=t[l-20].volume)/20,t[l].vol={num:d,ma5:i,ma10:e,ma20:s}}return t}(this.dataBounds.dataList);break;case l.BOLL:this.dataBounds.dataList=function(t){let i,e,s,a,o,h=0,r=0,n=0,l=0;for(let d=0;d<t.length;d++){n+=t[d].turnover,0!==(l+=t[d].volume)&&(t[d].averagePrice=n/l);let c=t[d].close;h+=c,r+=c,d>=24?(e=r/25,r-=t[d-24].close):e=r/(d+1),d>=25?(i=h/26,s=W(t.slice(d-25,d+1),i),h-=t[d-25].close):(i=h/(d+1),s=W(t.slice(0,d+1),i)),a=e+2*s,o=e-2*s,t[d].boll={up:a,mid:i,dn:o}}return t}(this.dataBounds.dataList);break;case l.BIAS:this.dataBounds.dataList=function(t){let i,e,s,a=0,o=0,h=0,r=0,n=0;for(let l=0;l<t.length;l++){r+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=r/n);let d=t[l].close;if(a+=d,o+=d,h+=d,l<6){let t=a/(l+1);i=(d-t)/t*100}else{let e=(a-=t[l-6].close)/6;i=(d-e)/e*100}if(l<12){let t=o/(l+1);e=(d-t)/t*100}else{let i=(o-=t[l-12].close)/12;e=(d-i)/i*100}if(l<24){let t=h/(l+1);s=(d-t)/t*100}else{let i=(h-=t[l-24].close)/24;s=(d-i)/i*100}t[l].bias={bias1:i,bias2:e,bias3:s}}return t}(this.dataBounds.dataList);break;case l.BRAR:this.dataBounds.dataList=function(t){let i=0,e=0,s=0,a=0,o=0,h=0,r=0,n=0;for(let l=0;l<t.length;l++){r+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=r/n);let d=t[l].high,c=t[l].low,u=t[l].open;if(o+=d-u,h+=u-c,l>25&&(o-=t[l-26].high-t[l-26].open,h-=t[l-26].open-t[l-26].low),0!==h&&(e=o/h*100),l>0){let e=t[l-1].close,o=d-e;o<0&&(o=0),s+=o;let h=e-c;h<0&&(h=0),0!==(a+=h)&&(i=s/a*100)}t[l].brar={br:i,ar:e}}return t}(this.dataBounds.dataList);break;case l.CCI:this.dataBounds.dataList=function(t){let i,e=0,s=0,a=0;for(let o=0;o<t.length;o++){s+=t[o].turnover,0!==(a+=t[o].volume)&&(t[o].averagePrice=s/a);let h=(t[o].high+t[o].low+t[o].close)/3;if(e+=h,o>=13){let s=e/14;e-=(t[o-13].high+t[o-13].low+t[o-13].close)/3;let a=0;for(let i=o-13;i<o+1;i++){let e=(t[i].high+t[i].low+t[i].close)/3;a+=Math.abs(e-s)}let r=a/14;i=0===r?0:200*(h-s)/3/r}else{let s=e/(o+1),a=0;for(let i=0;i<o+1;i++){let e=(t[i].high+t[i].low+t[i].close)/3;a+=Math.abs(e-s)}let r=a/(o+1);i=0===r?0:200*(h-s)/3/r}t[o].cci={cci:i}}return t}(this.dataBounds.dataList);break;case l.CR:this.dataBounds.dataList=function(t){let i,e,s,a,o,h,r,n,l=0,d=0,c=0,u=0,x=[],m=0,g=[],p=0,v=[],L=0,M=[],y=0,f=0;for(let P=0;P<t.length;P++){if(y+=t[P].turnover,0!==(f+=t[P].volume)&&(t[P].averagePrice=y/f),P>0){let i=t[P-1].high,e=t[P-1].low,s=(i+t[P-1].close+e+t[P-1].open)/4,a=t[P].high,o=t[P].low,h=a-s;h<0&&(h=0),d+=h;let r=s-o;if(r<0&&(r=0),c+=r,P>26){let i=(t[P-27].high+t[P-27].low+t[P-27].close+t[P-27].open)/4,e=t[P-26].high,s=t[P-26].low,a=e-i;a<0&&(a=0);let o=i-s;o<0&&(o=0),d-=a,c-=o}0!==c&&(l=d/c*100);let n=(t[P-1].high+t[P-1].low+t[P-1].close)/3,u=t[P].high-n;d+=u<=0?0:u;let x=n-t[P].low;c+=x<=0?0:x}u+=l,m+=l,p+=l,L+=l,o=P<10?u/(P+1):(u-=t[P-10].cr.cr)/10,x.push(o),h=P<20?m/(P+1):(m-=t[P-20].cr.cr)/20,g.push(h),r=P<40?p/(P+1):(p-=t[P-40].cr.cr)/40,v.push(r),n=P<60?L/(P+1):(L-=t[P-60].cr.cr)/60,M.push(n),i=P<5?x.get(0):x[P-5],e=P<9?g.get(0):g[P-9],s=P<17?v.get(0):v[P-17],a=P<25?M.get(0):M[P-25],t[P].cr={cr:l,ma1:i,ma2:e,ma3:s,ma4:a}}return t}(this.dataBounds.dataList);break;case l.DMA:this.dataBounds.dataList=function(t){let i,e,s,a,o=0,h=0,r=0,n=0,l=0;for(let d=0;d<t.length;d++){n+=t[d].turnover,0!==(l+=t[d].volume)&&(t[d].averagePrice=n/l);let c=t[d].close;o+=c,h+=c,r+=i=(s=d<10?o/(d+1):(o-=t[d-10].close)/10)-(a=d<50?h/(d+1):(h-=t.get[d-50].close)/50),e=d<10?r/(d+1):(r-=t[d-10].dma.dif)/10,t[d].dma={dif:i,difMa:e}}return t}(this.dataBounds.dataList);break;case l.DMI:this.dataBounds.dataList=function(t){let i,e,s,a=0,o=0,h=0,r=0,n=[],l=[],d=[],c=[],u=[],x=0,m=0;for(let g=0;g<t.length;g++){if(x+=t[g].turnover,0!==(m+=t[g].volume)&&(t[g].averagePrice=x/m),g>0){s=t[g-1].close,i=t[g].high-t[g-1].high,e=t[g-1].low-t[g].low;let x,m,p=t[g].high-t[g].low>Math.abs(t[g].high-s)?t[g].high-t[g].low:Math.abs(t[g].high-s),v=p>Math.abs(s)-t[g].low?p:Math.abs(s)-t[g].low;n.push(v),x=i>0&&i>e?i:0,l.push(x),m=e>0&&e>i?e:0,d.push(m);let L=0,M=0,y=0;for(let t=0;t<n.length;t++)L+=n[t],M+=l[t],y+=d[t];a=100*M/L,o=100*y/L;let f=Math.abs(o-a)/(o+a)*100;c.push(f);let P=0;for(let t=0;t<c.length;t++)P+=c[t];h=P/6,u.push(h);let A=0;A+=u[0],r=(A+=u[u.length-1])/2,g>=14&&(n.remove(0),l.remove(0),d.remove(0)),g>=19&&c.remove(0),g>=25&&u.remove(0)}t[g].dmi={pdi:a,mdi:o,adx:h,adxr:r}}return t}(this.dataBounds.dataList);break;case l.KDJ:case l.KD:this.dataBounds.dataList=F(this.dataBounds.dataList);break;case l.RSI:this.dataBounds.dataList=function(t){let i,e,s,a,o,h,r=0,n=0,l=0,d=0,c=0,u=0,x=0,m=0,g=0,p=0,v=0,L=0,M=0;for(let y=0;y<t.length;y++){if(L+=t[y].turnover,0!==(M+=t[y].volume)&&(t[y].averagePrice=L/M),y>0){let L=t[y].close-t[y-1].close;L>0?d+=L:c+=L;let M=L>0?L:0,f=Math.abs(L);y<6?(i=d/(y+1),e=(Math.abs(c)+d)/(y+1)):(i=(M+5*u)/6,e=(f+5*x)/6),u=i,x=e,r=i/e*100,y<12?(s=d/(y+1),a=(Math.abs(c)+d)/(y+1)):(s=(M+11*m)/12,a=(f+11*g)/12),m=s,g=a,n=s/a*100,y<24?(o=d/(y+1),h=(Math.abs(c)+d)/(y+1)):(o=(M+23*p)/24,h=(f+23*v)/24),p=o,v=h,l=o/h*100}t[y].rsi={rsi1:r,rsi2:n,rsi3:l}}return t}(this.dataBounds.dataList);break;case l.PSY:this.dataBounds.dataList=function(t){let i=0,e=0,s=0,a=0;for(let o=0;o<t.length;o++)s+=t[o].turnover,0!==(a+=t[o].volume)&&(t[o].averagePrice=s/a),o>0&&(e+=t[o].close-t[o-1].close>0?1:0,o>=12?(i=e/12*100,e-=t[o-11].close-t[o-12].close>0?1:0):i=e/o*100),t[o].psy={psy:i};return t}(this.dataBounds.dataList);break;case l.TRIX:this.dataBounds.dataList=function(t){let i,e,s,a,o=0,h=0,r=0,n=0,l=0,d=0,c=0,u=0,x=0,m=0;for(let g=0;g<t.length;g++){x+=t[g].turnover,0!==(m+=t[g].volume)&&(t[g].averagePrice=x/m);let p=t[g].close;r+=p,n=e=g<12?r/(g+1):(2*p+11*n)/13,l+=e,d=s=g<12?l/(g+1):(2*e+11*d)/13,c+=s,a=g<12?c/(g+1):(2*s+11*u)/13,0!==u&&(o=(a-u)/u*100),h+=o,u=a,g<20?i=h/(g+1):(i=h/20,h-=t[g-19].trix.trix),t[g].trix={trix:o,maTrix:i}}return t}(this.dataBounds.dataList);break;case l.OBV:this.dataBounds.dataList=function(t){let i,e=0,s=0,a=0;for(let o=0;o<t.length;o++){s+=t[o].turnover,0!==(a+=t[o].volume)&&(t[o].averagePrice=s/a);let h=t[o].close,r=t[o].high,n=r-h,l=t[o].volume*(h-t[o].low-n)/r;e+=l,i=o<30?e/(o+1):(e-=t[o-30].obv.obv)/30,t[o].obv={obv:l,maObv:i}}return t}(this.dataBounds.dataList);break;case l.VR:this.dataBounds.dataList=function(t){let i,e=0,s=0,a=0,o=0,h=0,r=0,n=0;for(let l=0;l<t.length;l++){if(r+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=r/n),l<24){let i=t[l].close,o=t[l].open,h=t[l].volume;i>o?e+=h:i<o?s+=h:a+=h}else for(let i=l-24;i<l;i++){let o=t[i].close,h=t[i].open,r=t[i].volume;i===l-24&&(e=0,s=0,a=0),o>h?e+=r:o<h?s+=r:a+=r}let d=s+.5*a;0!==d&&(o=(e+.5*a)/d*100),h+=o,i=l<30?h/(l+1):(h-=t[l-30].vr.vr)/30,t[l].vr={vr:o,maVr:i}}return t}(this.dataBounds.dataList);break;case l.WR:this.dataBounds.dataList=function(t){let i=0,e=0,s=0,a=Number.MIN_VALUE,o=Number.MAX_VALUE,h=Number.MIN_VALUE,r=Number.MAX_VALUE,n=Number.MIN_VALUE,l=Number.MAX_VALUE,d=0,c=0;for(let u=0;u<t.length;u++){d+=t[u].turnover,0!==(c+=t[u].volume)&&(t[u].averagePrice=d/c);let x=t[u].close;if(u<13){let d=t[u].high,c=t[u].low;a=Math.max(d,a),o=Math.min(c,o),h=Math.max(d,h),r=Math.min(c,r),n=Math.max(d,n),l=Math.min(c,l);let m=a-o;0!==m&&(i=(a-x)/m*100),e=i,s=i}else{for(let e=u-13;e<u;e++){e===u-13?(a=t[e].high,o=t[e].low):(a=Math.max(t[e].high,a),o=Math.min(t[e].low,o));let s=a-o;0!==s&&(i=(a-x)/s*100)}if(u<34){let i=t[u].high,a=t[u].low;h=Math.max(i,h),r=Math.min(a,r),n=Math.max(i,n),l=Math.min(a,l);let o=h-r;0!==o&&(e=(h-x)/o*100),s=e}else{for(let i=u-34;i<u;i++){i===u-34?(h=t[i].high,r=t[i].low):(h=Math.max(t[i].high,h),r=Math.min(t[i].low,r));let s=h-r;0!==s&&(e=(h-x)/s*100)}if(u<89){let i=t[u].high,e=t[u].low,a=(n=Math.max(i,n))-(l=Math.min(e,l));0!==a&&(s=(n-x)/a*100)}else for(let i=u-89;i<u;i++){i===u-89?(n=t[i].high,l=t[i].low):(n=Math.max(t[i].high,n),l=Math.min(t[i].low,l));let e=n-l;0!==e&&(s=(n-x)/e*100)}}}t[u].wr={wr1:i,wr2:e,wr3:s}}return t}(this.dataBounds.dataList);break;case l.MTM:this.dataBounds.dataList=function(t){let i,e,s=0,a=0,o=0;for(let h=0;h<t.length;h++){a+=t[h].turnover,0!==(o+=t[h].volume)&&(t[h].averagePrice=a/o);let r=t[h].close;s+=i=h<6?r-t[0].close:r-t[h-6].close,e=h<10?s/(h+1):(s-=t[h-10].mtm.mtm)/10,t[h].mtm={mtm:i,mtmMa:e}}return t}(this.dataBounds.dataList);break;case l.EMV:this.dataBounds.dataList=function(t){let i,e=0,s=0,a=0,o=[],h=0,r=0;for(let n=0;n<t.length;n++){let l=t[n].turnover;if(h+=l,0!==(r+=t[n].volume)&&(t[n].averagePrice=h/r),n>0){let i=t[n].high,e=t[n].low;a=((i+e)/2-(t[n-1].high+t[n-1].low)/2)*(i-e)/l}o.push(a),n<14?e+=a:e-=o[n-14],s+=e,i=n<9?s/(n+1):(s-=t[n-9].emv.emv)/9,t[n].emv={emv:e,maEmv:i}}return t}(this.dataBounds.dataList);break;case l.SAR:this.dataBounds.dataList=function(t){let i=0,e=-100,s=!1,a=0,o=0,h=0;for(let r=0;r<t.length;r++){o+=t[r].turnover,0!==(h+=t[r].volume)&&(t[r].averagePrice=o/h);let n=a,l=t[r].high,d=t[r].low;if(s){(-100===e||e<l)&&(e=l,i=Math.min(i+.02,2)),a=n+i*(e-n);let o=Math.min(t[Math.max(1,r)-1].low,d);a>t[r].low?(a=e,i=0,e=-100,s=!s):a>o&&(a=o)}else{(-100===e||e>d)&&(e=d,i=Math.min(i+.02,.2)),a=n+i*(e-n);let o=Math.max(t[Math.max(1,r)-1].high,l);a<t[r].high?(a=e,i=0,e=-100,s=!s):a<o&&(a=o)}t[r].sar={sar:a}}return t}(this.dataBounds.dataList)}}calcChartIndicator(){this.candleChart.isDisplayChart()&&this.calcIndicator(this.candleChart.indicatorType),this.isDisplayVolChart()&&this.calcIndicator(l.VOL),this.isDisplayIndicatorChart()&&this.calcIndicator(this.indicatorChart.indicatorType),this.freshen()}setDataList(t){this.dataBounds.dataList=t,this.dataBounds.moveToLast(),this.calcChartIndicator(),this.freshen()}setMainIndicatorType(t){this.candleChart.indicatorType!==t&&(this.candleChart.indicatorType=t,this.calcIndicator(t),this.freshen())}setSubIndicatorType(t){if(this.indicatorChart.indicatorType!==t){let i=this.isDisplayIndicatorChart()&&t===l.NO||!this.isDisplayIndicatorChart()&&t!==l.NO;this.indicatorChart.indicatorType=t,i&&(this.isShouldCalcChartHeight=!0),this.calcIndicator(t),this.freshen()}}setShowVolIndicatorChart(t){this.isDisplayVolChart()!==t&&(t?(this.volChart.indicatorType=l.VOL,this.calcIndicator(l.VOL)):this.volChart.indicatorType=l.NO,this.isShouldCalcChartHeight=!0,this.freshen())}isDisplayVolChart(){return this.volChart.isDisplayChart()}isDisplayIndicatorChart(){return this.indicatorChart.isDisplayChart()}};e.d(i,"kline",function(){return j}),e.d(i,"LineStyle",function(){return c}),e.d(i,"ChartStyle",function(){return M}),e.d(i,"CandleStyle",function(){return L}),e.d(i,"IndicatorType",function(){return l}),e.d(i,"YAxisTextPosition",function(){return m}),e.d(i,"YAxisPosition",function(){return x}),e.d(i,"IndicatorDisplayRule",function(){return A});const j={init:t=>new _(t)}}])});
//# sourceMappingURL=kline.min.js.map
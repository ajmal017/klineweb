!function(t){var i={};function e(a){if(i[a])return i[a].exports;var s=i[a]={i:a,l:!1,exports:{}};return t[a].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=t,e.c=i,e.d=function(t,i,a){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:a})},e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(a,s,function(i){return t[i]}.bind(null,s));return a},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="/",e(e.s=0)}([function(t,i,e){t.exports=e(1)},function(t,i,e){"use strict";e.r(i);var a=class{constructor(){this.contentRect={left:0,right:0,top:0,bottom:0},this.viewHeight=0,this.viewWidth=0}setChartDimens(t,i){this.viewWidth=t,this.viewHeight=i,this.restrainViewPort(this.contentLeft(),this.contentTop(),t-this.contentRight(),i-this.contentBottom())}restrainViewPort(t,i,e,a){this.contentRect.left=t,this.contentRect.right=this.viewWidth-e,this.contentRect.top=i,this.contentRect.bottom=this.viewHeight-a}contentTop(){return this.contentRect.top}contentLeft(){return this.contentRect.left}contentRight(){return this.contentRect.right}contentBottom(){return this.contentRect.bottom}getContentCenter(){let t={};return t.x=(this.contentRect.left+this.contentRect.right)/2,t.y=(this.contentRect.top+this.contentRect.bottom)/2,t}isInBoundsX(t){return this.isInBoundsLeft(t)&&this.isInBoundsRight(t)}isInBoundsLeft(t){return this.contentRect.left<=t+1}isInBoundsRight(t){let i=parseInt(100*t)/100;return this.contentRect.right>=i-1}};var s=class{constructor(t){this.viewPortHandler=t,this.dataList=[],this.min=0,this.range=120,this.maxRange=180,this.minRange=20,this.dataSpace=0,this.dataMarginSpaceRate=.2,this.currentDataPos=0}space(){this.dataSpace=(this.viewPortHandler.contentRight()-this.viewPortHandler.contentLeft())/this.range}moveToLast(){this.dataList.length>this.range?(this.min=this.dataList.length-this.range,this.currentDataPos=this.dataList.length-1):this.min=0}calcCurrentDataIndex(t){let i=+Math.ceil(t/this.dataSpace).toFixed(0);this.currentDataPos=this.min+i-1}};var o=class{constructor(t,i){this.dataBounds=t,this.viewPortHandler=i,this.chartTop=0,this.chartHeight=0}setChartDimens(t,i){this.chartHeight=t,this.chartTop=i}getY(t,i,e){return this.chartTop+(1-(t-i)/e)*this.chartHeight}};var r=class extends o{constructor(t,i,e){super(i,e),this.grid=t}draw(t){this.grid.display&&(t.strokeStyle=this.grid.lineColor,t.lineWidth=this.grid.lineSize,t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentTop()),t.lineTo(this.viewPortHandler.contentRight(),this.viewPortHandler.contentTop()),t.lineTo(this.viewPortHandler.contentRight(),this.viewPortHandler.contentBottom()),t.lineTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentBottom()),t.lineTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentTop()),t.stroke(),t.closePath())}};var h={canvas:document.createElement("canvas").getContext("2d"),formatDate(t){let i=new Date(t),e=(i.getMonth()+1).toString(),a=i.getDate().toString(),s=i.getHours().toString(),o=i.getMinutes().toString();return(1===e.length?"0"+e:e)+"-"+(1===a.length?"0"+a:a)+" "+(1===s.length?"0"+s:s)+":"+(1===o.length?"0"+o:o)},calcTextWidth(t,i){return this.canvas.font=t,this.canvas.measureText(i).width},nice(t){let i=Math.floor(Math.log(t)/Math.log(10)),e=Math.pow(10,i),a=t/e,s=0;return t=(s=a<1?1:a<2?2:a<3?3:a<5?5:10)*e,i>=-20?+t.toFixed(i<0?-i:0):t},getIntervalPrecision(t){let i=t.toString(),e=i.indexOf("e");if(e>0){let t=+i.slice(e+1);return t<0?-t:0}{let t=i.indexOf(".");return t<0?0:i.length-1-t}},round:(t,i)=>(null==i&&(i=10),i=Math.min(Math.max(0,i),20),t=(+t).toFixed(i))};var n=class extends o{constructor(t,i){super(t,i),this.values=[],this.valueCount=0}computeAxisValues(t,i){let e=i-t;if(e<0)return this.values=[],void(this.valueCount=0);let a=+h.nice(e/5),s=h.getIntervalPrecision(a),o=+h.round(Math.ceil(t/a)*a,s),r=+h.round(Math.floor(i/a)*a,s),n=0,l=o;if(0!==a)for(;l<=+r;)++n,l+=a;this.valueCount=n,this.values=[];let d=0;for(l=o;d<n;)this.values[d]=l,l+=a,++d}};const l={NO:"NO",MA:"MA",VOL:"VOL",MACD:"MACD",BOLL:"BOLL",KDJ:"KDJ",KD:"KD",RSI:"RSI",BIAS:"BIAS",BRAR:"BRAR",CCI:"CCI",DMI:"DMI",CR:"CR",PSY:"PSY",DMA:"DMA",TRIX:"TRIX",OBV:"OBV",VR:"VR",WR:"WR",MTM:"MTM",EMV:"EMV",SAR:"SAR"};var d=class{constructor(){this.lineSize=1,this.increasingColor="#5DB300",this.decreasingColor="#FF4A4A",this.lineColors=["#898989","#F5A623","#F601FF","#1587DD","#50A300"]}};const c={DASH:"dash",SOLID:"solid"};var x=class{constructor(){this.display=!0,this.color="#707070",this.axisLine={display:!0,color:"#707070",size:1},this.tickText={display:!0,position:u.OUTSIDE,color:"#707070",size:12,margin:3,valueFormatter:null},this.tickLine={display:!0,size:3,color:"#707070"},this.separatorLine={display:!1,size:1,color:"#B8B8B8",style:c.DASH,dashValue:[8,8]}}};const m={LEFT:"left",RIGHT:"right"},u={OUTSIDE:"outside",INSIDE:"inside"};var g=class extends x{constructor(){super(),this.yAxisPosition=m.RIGHT,this.yAxisMaxWidth=80,this.yAxisMinWidth=40}needsOffset(){return((this.tickText.display||this.tickLine.display||this.tickText.margin>0)&&this.tickText.position===u.OUTSIDE||this.axisLine.display)&&this.display}getRequiredWidthSpace(){let t=0;if(this.tickText.position===u.OUTSIDE&&(t+=h.calcTextWidth(2*this.tickText.size,"0000000")+2*this.tickText.margin,this.display&&this.tickLine.display&&(t+=2*this.tickLine.size)),this.display&&this.axisLine.display&&(t+=this.axisLine.size),t===this.axisLine.size)return t;let i=t;return i>0&&(i=2*this.yAxisMaxWidth,t=Math.min(i,Math.max(t,2*this.yAxisMinWidth))),t}};var L=class extends n{constructor(t,i,e){super(i,e),this.axisMaximum=0,this.axisMinimum=0,this.axisRange=0,this.yAxis=t}drawAxisLine(t){this.yAxis.display&&this.yAxis.axisLine.display&&(t.strokeStyle=this.yAxis.axisLine.color||this.yAxis.color,t.lineWidth=this.yAxis.axisLine.size,t.beginPath(),this.yAxis.yAxisPosition===m.LEFT?(t.moveTo(this.viewPortHandler.contentLeft(),this.chartTop),t.lineTo(this.viewPortHandler.contentLeft(),this.chartTop+this.chartHeight)):(t.moveTo(this.viewPortHandler.contentRight(),this.chartTop),t.lineTo(this.viewPortHandler.contentRight(),this.chartTop+this.chartHeight)),t.stroke(),t.closePath())}drawAxisLabels(t){if(!this.yAxis.display||!this.yAxis.tickText.display)return;let i;i=this.yAxis.yAxisPosition===m.LEFT?this.yAxis.tickText.position===u.OUTSIDE?this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentLeft()-2*this.yAxis.tickLine.size-2*this.yAxis.tickText.margin:this.viewPortHandler.contentLeft()-2*this.yAxis.tickText.margin:this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentLeft()+2*this.yAxis.tickLine.size+2*this.yAxis.tickText.margin:this.viewPortHandler.contentLeft()+2*this.yAxis.tickText.margin:this.yAxis.tickText.position===u.OUTSIDE?this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentRight()+2*this.yAxis.tickLine.size+2*this.yAxis.tickText.margin:this.viewPortHandler.contentRight()+2*this.yAxis.tickText.margin:this.yAxis.display&&this.yAxis.tickLine.display?this.viewPortHandler.contentRight()-2*this.yAxis.tickLine.size-2*this.yAxis.tickText.margin:this.viewPortHandler.contentRight()-2*this.yAxis.tickText.margin,t.font=2*this.yAxis.tickText.size+"px Arial",t.fillStyle=this.yAxis.tickText.color||this.yAxis.color;let e=2*this.yAxis.tickText.size,a=e/2,s=this.yAxis.tickText.valueFormatter;for(let o=0;o<this.values.length;o++){let r=this.getValueY(this.values[o]),h=this.values[o].toString();if(s&&(h=s(this.values[o])||"--"),this.checkShowLabel(r,e)){this.yAxis.yAxisPosition===m.LEFT&&this.yAxis.tickText.position===u.OUTSIDE||this.yAxis.yAxisPosition===m.RIGHT&&this.yAxis.tickText.position!==u.OUTSIDE?t.textAlign="right":t.textAlign="left";let e=r+a;t.fillText(h,i,e)}}t.textAlign="left"}drawSeparatorLines(t){if(!this.yAxis.display||!this.yAxis.separatorLine.display)return;t.strokeStyle=this.yAxis.separatorLine.color||this.yAxis.color,t.lineWidth=this.yAxis.separatorLine.size;let i=2*this.yAxis.tickText.size;this.xAxis.separatorLine.style===c.DASH&&t.setLineDash(this.xAxis.separatorLine.dashValue);for(let e=0;e<this.values.length;e++){let a=this.getValueY(this.values[e]);this.checkShowLabel(a,i)&&(t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),a),t.lineTo(this.viewPortHandler.contentRight(),a),t.stroke(),t.closePath())}t.setLineDash([])}drawTickLines(t){if(!this.yAxis.display||!this.yAxis.tickLine.display)return;t.lineWidth=1,t.strokeStyle=this.yAxis.axisLine.color||this.yAxis.color;let i,e,a=2*this.yAxis.tickText.size;this.yAxis.yAxisPosition===m.LEFT?(i=this.viewPortHandler.contentLeft(),e=this.yAxis.tickText.position===u.OUTSIDE?i-2*this.yAxis.tickLine.size:i+2*this.yAxis.tickLine.size):(i=this.viewPortHandler.contentRight(),e=this.yAxis.tickText.position===u.OUTSIDE?i+2*this.yAxis.tickLine.size:i-2*this.yAxis.tickLine.size);for(let s=0;s<this.values.length;s++){let o=this.getValueY(this.values[s]);this.checkShowLabel(o,a)&&(t.beginPath(),t.moveTo(i,o),t.lineTo(e,o),t.stroke(),t.closePath())}}checkShowLabel(t,i){return t>this.chartTop+i&&t<this.chartTop+this.chartHeight-i}getYAxisDataMinMax(t,i=!1,e=!1){let a=this.dataBounds.dataList,s=this.dataBounds.min,o=Math.min(s+this.dataBounds.range,a.length),r=[Number.MAX_VALUE,Number.MIN_VALUE];if(e)for(let h=s;h<o;h++){let t=a[h];r[0]=Math.min(t.averagePrice,r[0]),r[0]=Math.min(t.close,r[0]),r[1]=Math.max(t.averagePrice,r[1]),r[1]=Math.max(t.close,r[1])}else for(let h=s;h<o;h++){let e=a[h];this.calcIndexMinMax(e,t,r),i&&(r[0]=Math.min(e.low,r[0]),r[1]=Math.max(e.high,r[1]))}r[0]!==Number.MAX_VALUE&&r[1]!==Number.MIN_VALUE&&(this.axisMinimum=r[0],this.axisMaximum=r[1],this.computeAxis())}calcIndexMinMax(t,i,e){switch(i){case l.MA:e[0]=Math.min(t.ma.ma5,e[0]),e[0]=Math.min(t.ma.ma10,e[0]),e[0]=Math.min(t.ma.ma20,e[0]),e[0]=Math.min(t.ma.ma60,e[0]),e[1]=Math.max(t.ma.ma5,e[1]),e[1]=Math.max(t.ma.ma10,e[1]),e[1]=Math.max(t.ma.ma20,e[1]),e[1]=Math.max(t.ma.ma60,e[1]);break;case l.MACD:e[0]=Math.min(t.macd.dea,e[0]),e[0]=Math.min(t.macd.diff,e[0]),e[0]=Math.min(t.macd.macd,e[0]),e[1]=Math.max(t.macd.dea,e[1]),e[1]=Math.max(t.macd.diff,e[1]),e[1]=Math.max(t.macd.macd,e[1]);break;case l.VOL:e[0]=Math.min(t.vol.ma5,0),e[0]=Math.min(t.vol.ma10,0),e[0]=Math.min(t.vol.ma20,0),e[0]=Math.min(t.vol.num,0),e[1]=Math.max(t.vol.ma5,e[1]),e[1]=Math.max(t.vol.ma10,e[1]),e[1]=Math.max(t.vol.ma20,e[1]),e[1]=Math.max(t.vol.num,e[1]);break;case l.BOLL:e[0]=Math.min(t.boll.up,e[0]),e[0]=Math.min(t.boll.mid,e[0]),e[0]=Math.min(t.boll.dn,e[0]),e[0]=Math.min(t.low,e[0]),e[1]=Math.max(t.boll.up,e[1]),e[1]=Math.max(t.boll.mid,e[1]),e[1]=Math.max(t.boll.dn,e[1]),e[1]=Math.max(t.high,e[1]);break;case l.BIAS:e[0]=Math.min(t.bias.bias1,e[0]),e[0]=Math.min(t.bias.bias2,e[0]),e[0]=Math.min(t.bias.bias3,e[0]),e[1]=Math.max(t.bias.bias1,e[1]),e[1]=Math.max(t.bias.bias2,e[1]),e[1]=Math.max(t.bias.bias3,e[1]);break;case l.BRAR:e[0]=Math.min(t.brar.br,e[0]),e[0]=Math.min(t.brar.ar,e[0]),e[1]=Math.max(t.brar.br,e[1]),e[1]=Math.max(t.brar.ar,e[1]);break;case l.CCI:e[0]=Math.min(t.cci.cci,e[0]),e[1]=Math.max(t.cci.cci,e[1]);break;case l.CR:e[0]=Math.min(t.cr.cr,e[0]),e[0]=Math.min(t.cr.ma1,e[0]),e[0]=Math.min(t.cr.ma2,e[0]),e[0]=Math.min(t.cr.ma3,e[0]),e[0]=Math.min(t.cr.ma4,e[0]),e[1]=Math.max(t.cr.cr,e[1]),e[1]=Math.max(t.cr.ma1,e[1]),e[1]=Math.max(t.cr.ma2,e[1]),e[1]=Math.max(t.cr.ma3,e[1]),e[1]=Math.max(t.cr.ma4,e[1]);break;case l.DMA:e[0]=Math.min(t.dma.dif,e[0]),e[0]=Math.min(t.dma.difMa,e[0]),e[1]=Math.max(t.dma.dif,e[1]),e[1]=Math.max(t.dma.difMa,e[1]);break;case l.DMI:e[0]=Math.min(t.dmi.pdi,e[0]),e[0]=Math.min(t.dmi.mdi,e[0]),e[0]=Math.min(t.dmi.adx,e[0]),e[0]=Math.min(t.dmi.adxr,e[0]),e[1]=Math.max(t.dmi.pdi,e[1]),e[1]=Math.max(t.dmi.mdi,e[1]),e[1]=Math.max(t.dmi.adx,e[1]),e[1]=Math.max(t.dmi.adxr,e[1]);break;case l.KDJ:e[0]=Math.min(t.kdj.k,e[0]),e[0]=Math.min(t.kdj.d,e[0]),e[0]=Math.min(t.kdj.j,e[0]),e[1]=Math.max(t.kdj.k,e[1]),e[1]=Math.max(t.kdj.d,e[1]),e[1]=Math.max(t.kdj.j,e[1]);break;case l.KD:e[0]=Math.min(t.kdj.k,e[0]),e[0]=Math.min(t.kdj.d,e[0]),e[1]=Math.max(t.kdj.k,e[1]),e[1]=Math.max(t.kdj.d,e[1]);break;case l.RSI:e[0]=Math.min(t.rsi.rsi1,e[0]),e[0]=Math.min(t.rsi.rsi2,e[0]),e[0]=Math.min(t.rsi.rsi3,e[0]),e[1]=Math.max(t.rsi.rsi1,e[1]),e[1]=Math.max(t.rsi.rsi2,e[1]),e[1]=Math.max(t.rsi.rsi3,e[1]);break;case l.PSY:e[0]=Math.min(t.psy.psy,e[0]),e[1]=Math.max(t.psy.psy,e[1]);break;case l.TRIX:e[0]=Math.min(t.trix.trix,e[0]),e[0]=Math.min(t.trix.maTrix,e[0]),e[1]=Math.max(t.trix.trix,e[1]),e[1]=Math.max(t.trix.maTrix,e[1]);break;case l.OBV:e[0]=Math.min(t.obv.obv,e[0]),e[0]=Math.min(t.obv.maObv,e[0]),e[1]=Math.max(t.obv.obv,e[1]),e[1]=Math.max(t.obv.maObv,e[1]);break;case l.VR:e[0]=Math.min(t.vr.vr,e[0]),e[0]=Math.min(t.vr.maVr,e[0]),e[1]=Math.max(t.vr.vr,e[1]),e[1]=Math.max(t.vr.maVr,e[1]);break;case l.WR:e[0]=Math.min(t.wr.wr1,e[0]),e[0]=Math.min(t.wr.wr2,e[0]),e[0]=Math.min(t.wr.wr3,e[0]),e[1]=Math.max(t.wr.wr1,e[1]),e[1]=Math.max(t.wr.wr2,e[1]),e[1]=Math.max(t.wr.wr3,e[1]);break;case l.MTM:e[0]=Math.min(t.mtm.mtm,e[0]),e[0]=Math.min(t.mtm.mtmMa,e[0]),e[1]=Math.max(t.mtm.mtm,e[1]),e[1]=Math.max(t.mtm.mtmMa,e[1]);break;case l.EMV:e[0]=Math.min(t.emv.emv,e[0]),e[0]=Math.min(t.emv.maEmv,e[0]),e[1]=Math.max(t.emv.emv,e[1]),e[1]=Math.max(t.emv.maEmv,e[1]);break;case l.SAR:e[0]=Math.min(t.sar.sar,e[0]),e[1]=Math.max(t.sar.sar,e[1]),e[0]=Math.min(t.low,e[0]),e[1]=Math.max(t.high,e[1])}return e}computeAxis(){let t=this.axisMinimum,i=this.axisMaximum,e=Math.abs(i-t);0===e&&(i+=1,t-=1,e=Math.abs(i-t)),this.axisMinimum=t-e/100*10,this.axisMaximum=i+e/100*20,this.axisRange=Math.abs(this.axisMaximum-this.axisMinimum),this.computeAxisValues(this.axisMinimum,this.axisMaximum)}getValueY(t){return this.getY(t,this.axisMinimum,this.axisRange)}};var p=class extends o{constructor(t,i,e,a,s,o=l.MACD){super(a,s),this.indicator=t,this.xAxis=i,this.yAxisChart=new L(e,a,s),this.indicatorType=o}setChartDimens(t,i){super.setChartDimens(t,i),this.yAxisChart.setChartDimens(t,i)}draw(t){this.drawChartHorizontalSeparatorLine(t),this.yAxisChart.getYAxisDataMinMax(this.indicatorType),this.yAxisChart.drawSeparatorLines(t),this.yAxisChart.drawTickLines(t),this.drawIndicator(t),this.yAxisChart.drawAxisLine(t),this.yAxisChart.drawAxisLabels(t)}drawChartHorizontalSeparatorLine(t){t.lineWidth=this.xAxis.axisLine.size,t.strokeStyle=this.xAxis.axisLine.color,t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),this.chartTop),t.lineTo(this.viewPortHandler.contentRight(),this.chartTop),t.closePath(),t.stroke()}drawIndicator(t,i=!1){switch(this.indicatorType){case l.MA:this.drawLines(t,"ma",["ma5","ma10","ma20","ma60"]);break;case l.MACD:this.drawBarLines(t,"macd","macd",["diff","dea"],(i,e,a)=>{let s=(i.macd||{}).macd,o=((e||{}).macd||{}).macd;s>0?(t.strokeStyle=this.indicator.increasingColor,t.fillStyle=this.indicator.increasingColor):(t.strokeStyle=this.indicator.decreasingColor,t.fillStyle=this.indicator.decreasingColor),(o||0===o)&&s>o?t.strokeRect(a[0],a[1],a[2]-a[0],a[3]-a[1]):t.fillRect(a[0],a[1],a[2]-a[0],a[3]-a[1])});break;case l.VOL:this.drawBarLines(t,"vol","num",["ma5","ma10","ma20"],(i,e,a)=>{let s=i.close,o=(e||{}).close;t.fillStyle=(o||0===o)&&s>o?this.indicator.increasingColor:this.indicator.decreasingColor,t.fillRect(a[0],a[1],a[2]-a[0],a[3]-a[1])});break;case l.BOLL:this.drawLines(t,"boll",["up","mid","dn"],(e,a)=>{let s=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate)/2;this.drawOhlc(t,s,e,a,i)});break;case l.BIAS:this.drawLines(t,"bias",["bias1","bias2","bias3"]);break;case l.BRAR:this.drawLines(t,"brar",["br","ar"]);break;case l.CCI:this.drawLines(t,"cci",["cci"]);break;case l.CR:this.drawLines(t,"cr",["cr","ma1","ma2","ma3","ma4"]);break;case l.DMA:this.drawLines(t,"dma",["dif","difMa"]);break;case l.DMI:this.drawLines(t,"dmi",["mdi","pdi","adx","adxr"]);break;case l.KDJ:this.drawLines(t,"kdj",["k","d","j"]);break;case l.KD:this.drawLines(t,"kd",["k","d"]);break;case l.RSI:this.drawLines(t,"rsi",["rsi1","rsi2","rsi3"]);break;case l.PSY:this.drawLines(t,"psy",["psy"]);break;case l.TRIX:this.drawLines(t,"trix",["trix","maTrix"]);break;case l.OBV:this.drawLines(t,"obv",["obv","maObv"]);break;case l.VR:this.drawLines(t,"vr",["vr","maVr"]);break;case l.WR:this.drawLines(t,"wr",["wr1","wr2","wr3"]);break;case l.MTM:this.drawLines(t,"mtm",["mtm","mtmMa"]);break;case l.EMV:this.drawLines(t,"emv",["emv","maEmv"]);break;case l.SAR:this.drawSar(t,i)}}drawSar(t,i){t.save(),t.beginPath(),t.rect(this.viewPortHandler.contentLeft(),this.chartTop,this.viewPortHandler.contentRight()-this.viewPortHandler.contentLeft(),this.viewPortHandler.contentBottom()-this.chartTop),t.closePath(),t.clip(),t.lineWidth=1;let e=this.viewPortHandler.contentLeft(),a=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),s=a/2,o=this.dataBounds.min;for(;o<this.dataBounds.dataList.length&&o<this.dataBounds.min+this.dataBounds.range;){let r=(e+(e+a))/2,h=this.dataBounds.dataList[o];this.drawOhlc(t,s,r,h,i);let n=h.sar.sar;if(n||0===n){let i=this.getValueY(n);n<(h.high+h.low)/2?t.strokeStyle=this.indicator.increasingColor:t.strokeStyle=this.indicator.decreasingColor,t.beginPath(),t.arc(r,i,s,2*Math.PI,0,!0),t.stroke(),t.closePath()}e+=this.dataBounds.dataSpace,++o}t.restore()}drawBarLines(t,i,e,a,s){let o=this.viewPortHandler.contentLeft(),r=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),h=r/2,n=this.dataBounds.min,l=[],d=[];for(;n<this.dataBounds.dataList.length&&n<this.dataBounds.min+this.dataBounds.range;){let t,c=(o+(o+r))/2,x=this.dataBounds.dataList[n];n>0&&(t=this.dataBounds.dataList[n-1]);let m=x[i],u=m[e];if(u||0===u){l[0]=c-h,l[2]=c+h;let i=this.getValueY(u),e=this.getValueY(0);l[1]=i,l[3]=e,s(x,t,l)}for(let i=0;i<a.length;i++){let t=m[a[i]],e=this.getValueY(t);d[i]?d[i].push({x:c,y:e}):d[i]=[{x:c,y:e}]}o+=this.dataBounds.dataSpace,++n}this.drawLine(t,d)}drawLines(t,i,e,a){let s=this.viewPortHandler.contentLeft(),o=this.dataBounds.min,r=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),h=[];for(;o<this.dataBounds.dataList.length&&o<this.dataBounds.min+this.dataBounds.range;){let t=(s+(s+r))/2,n=this.dataBounds.dataList[o];a&&a(t,n);let l=n[i];for(let i=0;i<e.length;i++){let a=l[e[i]],s=this.getValueY(a);h[i]?h[i].push({x:t,y:s}):h[i]=[{x:t,y:s}]}s+=this.dataBounds.dataSpace,++o}this.drawLine(t,h)}drawLine(t,i){for(let e=0;e<i.length;e++){let a=i[e];if(a.length>0){t.strokeStyle=this.indicator.lineColors[e],t.beginPath(),t.moveTo(a[0].x,a[0].y);for(let i=1;i<a.length;i++)t.lineTo(a[i].x,a[i].y);t.stroke(),t.closePath()}}}drawOhlc(t,i,e,a,s){if(!s){let s=this.getValueY(a.open),o=this.getValueY(a.close),r=this.getValueY(a.high),h=this.getValueY(a.low);a.close>a.open?t.strokeStyle=this.indicator.increasingColor:t.strokeStyle=this.indicator.decreasingColor,this.drawOhlcLines(t,i,e,s,o,r,h)}}drawOhlcLines(t,i,e,a,s,o,r){t.beginPath(),t.moveTo(e,o),t.lineTo(e,r),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(e-i,a),t.lineTo(e,a),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(e+i,s),t.lineTo(e,s),t.stroke(),t.closePath()}getValueY(t){return this.getY(t,this.yAxisChart.axisMinimum,this.yAxisChart.axisRange)}isDisplayChart(){return this.indicatorType!==l.NO}};const v={SOLID:"solid",STROKE:"stroke",INCREASING_STROKE:"increasing_stroke",DECREASING_STROKE:"decreasing_stroke",OHLC:"ohlc"},M={CANDLE:"candle",TIME_LINE:"time_line"};var y=class{constructor(){this.chartStyle=M.CANDLE,this.timeChart={timeLineSize:1,timeLineColor:"#D8D8D8",timeLineFillColor:"#f4f4f4",timeAverageLineColor:"#F5A623"},this.candleChart={candleStyle:v.OHLC,increasingColor:"#5DB300",decreasingColor:"#FF4A4A"},this.lowestHighestPriceMarkTextColor="#898989",this.lowestHighestPriceMarkTextSize=10,this.lowestHighestValueFormatter=null,this.highestPriceMark={display:!0,color:"#898989",textSize:10,valueFormatter:null},this.lowestPriceMark={display:!0,color:"#898989",textSize:10,valueFormatter:null},this.lastPriceMark={display:!0,lineStyle:c.DASH,dashValue:[8,8],lineSize:1,lineColor:"#B9B9B9"}}};var A=class extends p{constructor(t,i,e,a,s){super(i,null,e,a,s),this.candle=t,this.indicatorType=l.MA,this.highestMarkData={},this.lowestMarkData={}}draw(t){let i=this.candle.chartStyle===M.TIME_LINE;this.yAxisChart.getYAxisDataMinMax(this.indicatorType,!0,i),this.yAxisChart.drawSeparatorLines(t),this.yAxisChart.drawTickLines(t),i?this.drawTimeLine(t):(this.drawCandle(t),this.drawIndicator(t,!0),this.drawHighestPriceMark(t),this.drawLowestPriceMark(t)),this.drawLastPriceMark(t),this.yAxisChart.drawAxisLine(t),this.yAxisChart.drawAxisLabels(t)}drawCandle(t){t.lineWidth=1;let i=this.dataBounds.dataList,e=this.viewPortHandler.contentLeft(),a=this.dataBounds.min,s=this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate),o=s/2,r=[],h=Number.MIN_VALUE,n=-1,l=Number.MAX_VALUE,d=-1;for(;a<i.length&&a<this.dataBounds.min+this.dataBounds.range;){let c=e+s,x=(e+c)/2,m=i[a],u=m.high,g=m.low;h<u&&(h=u,n=x),g<l&&(l=g,d=x);let L=this.getValueY(m.open),p=this.getValueY(m.close),M=this.getValueY(u),y=this.getValueY(g);if(m.close>m.open?(t.strokeStyle=this.candle.candleChart.increasingColor,t.fillStyle=this.candle.candleChart.increasingColor):(t.strokeStyle=this.candle.candleChart.decreasingColor,t.fillStyle=this.candle.candleChart.decreasingColor),this.candle.candleChart.candleStyle!==v.OHLC){let i=[],a=[];switch(L>p?(i[0]=M,i[1]=p,a[0]=L,a[1]=y,r=[e,p,c-e,L-p]):L<p?(i[0]=M,i[1]=L,a[0]=p,a[1]=y,r=[e,L,c-e,p-L]):(i[0]=M,i[1]=L,a[0]=p,a[1]=y,r=[e,L,c-e,1]),t.beginPath(),t.moveTo(x,i[0]),t.lineTo(x,i[1]),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(x,a[0]),t.lineTo(x,a[1]),t.stroke(),t.closePath(),this.candle.candleChart.candleStyle){case v.SOLID:t.fillRect(r[0],r[1],r[2],r[3]);break;case v.STROKE:t.strokeRect(r[0],r[1],r[2],r[3]);break;case v.INCREASING_STROKE:m.close>m.open?t.strokeRect(r[0],r[1],r[2],r[3]):t.fillRect(r[0],r[1],r[2],r[3]);break;case v.DECREASING_STROKE:m.close>m.open?t.fillRect(r[0],r[1],r[2],r[3]):t.strokeRect(r[0],r[1],r[2],r[3])}}else this.drawOhlcLines(t,o,x,L,p,M,y);e+=this.dataBounds.dataSpace,++a}this.highestMarkData={x:n,price:h},this.lowestMarkData={x:d,price:l}}drawHighestPriceMark(t){let i=this.highestMarkData.price;if(i===Number.MIN_VALUE||!this.candle.highestPriceMark.display)return;let e=this.candle.highestPriceMark.color||this.candle.lowestHighestPriceMarkTextColor,a=this.candle.highestPriceMark.textSize||this.candle.lowestHighestPriceMarkTextSize,s=this.candle.highestPriceMark.valueFormatter||this.candle.lowestHighestValueFormatter;this.drawLowestHighestPriceMark(t,this.highestMarkData.x,i,e,a,s,!0)}drawLowestPriceMark(t){let i=this.lowestMarkData.price;if(i===Number.MAX_VALUE||!this.candle.lowestPriceMark.display)return;let e=this.candle.lowestPriceMark.color||this.candle.lowestHighestPriceMarkTextColor,a=this.candle.lowestPriceMark.textSize||this.candle.lowestHighestPriceMarkTextSize,s=this.candle.lowestPriceMark.valueFormatter||this.candle.lowestHighestValueFormatter;this.drawLowestHighestPriceMark(t,this.lowestMarkData.x,i,e,a,s)}drawLowestHighestPriceMark(t,i,e,a,s,o,r=!1){t.save(),t.beginPath(),t.rect(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentTop(),this.viewPortHandler.contentRight()-this.viewPortHandler.contentLeft(),this.chartTop+this.chartHeight),t.closePath(),t.clip();let h=this.getValueY(e),n=i,l=h+(r?-4:4);t.textAlign="left",t.lineWidth=1,t.strokeStyle=a,t.fillStyle=a,t.beginPath(),t.moveTo(n,l),t.lineTo(n-4,l+(r?-4:4)),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(n,l),t.lineTo(n+4,l+(r?-4:4)),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(n,l),l+=r?-10:10,t.lineTo(n,l),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(n,l),t.lineTo(n+10,l),t.stroke(),t.closePath(),t.font=2*s+"px Arial";let d=e.toFixed(2);o&&(d=o(e)+""),t.fillText(d,n+14,h+(r?-s:2*s)),t.restore()}drawLastPriceMark(t){if(!this.candle.lastPriceMark.display||0===this.dataBounds.dataList.length)return;let i=this.dataBounds.dataList[this.dataBounds.dataList.length-1].close,e=this.getValueY(i);e=Math.max(this.chartTop+.05*this.chartHeight,Math.min(e,this.chartTop+.98*this.chartHeight)),t.strokeStyle=this.candle.lastPriceMark.lineColor,t.lineWidth=this.candle.lastPriceMark.lineSize,this.candle.lastPriceMark.lineStyle===c.DASH&&t.setLineDash(this.candle.lastPriceMark.dashValue),t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),e),t.lineTo(this.viewPortHandler.contentRight(),e),t.stroke(),t.closePath(),t.setLineDash([])}drawTimeLine(t){let i=[],e=[{x:this.viewPortHandler.contentLeft(),y:this.chartTop+this.chartHeight}],a=[];t.lineWidth=this.candle.timeChart.timeLineSize;let s=this.dataBounds.dataList,o=this.viewPortHandler.contentLeft(),r=this.dataBounds.min,h=this.dataBounds.dataSpace-this.dataBounds.dataMarginSpaceRate*this.dataBounds.dataSpace;for(;r<this.dataBounds.dataList.length&&r<this.dataBounds.min+this.dataBounds.range;){let t=(o+(o+h))/2,n=s[r],l=this.getValueY(n.close),d=this.getValueY(n.averagePrice);i.push({x:t,y:l}),n.averagePrice&&a.push({x:t,y:d}),r===this.dataBounds.min?(e.push({x:this.viewPortHandler.contentLeft(),y:l}),e.push({x:t,y:l})):r===this.dataBounds.min+this.dataBounds.range-1?(e.push({x:t,y:l}),e.push({x:this.viewPortHandler.contentRight(),y:l}),e.push({x:this.viewPortHandler.contentRight(),y:this.chartHeight+this.chartTop})):r===this.dataBounds.dataList.length-1?(e.push({x:t,y:l}),e.push({x:t,y:this.chartTop+this.chartHeight})):e.push({x:t,y:l}),o+=this.dataBounds.dataSpace,++r}if(i.length>0){t.strokeStyle=this.candle.timeChart.timeLineColor,t.beginPath(),t.moveTo(i[0].x,i[0].y);for(let e=1;e<i.length;e++)t.lineTo(i[e].x,i[e].y);t.stroke(),t.closePath()}if(e.length>0){t.fillStyle=this.candle.timeChart.timeLineFillColor,t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fill()}if(a.length>0){t.strokeStyle=this.candle.timeChart.timeAverageLineColor,t.beginPath(),t.moveTo(a[0].x,a[0].y);for(let i=1;i<a.length;i++)t.lineTo(a[i].x,a[i].y);t.stroke(),t.closePath()}}};var w=class extends n{constructor(t,i,e){super(i,e),this.xAxis=t}draw(t){this.computeAxis(),this.drawAxisLine(t),this.drawTickLines(t),this.drawAxisLabels(t),this.drawSeparatorLines(t)}drawAxisLine(t){this.xAxis.display&&this.xAxis.axisLine.display&&(t.strokeStyle=this.xAxis.axisLine.color||this.xAxis.color,t.lineWidth=this.xAxis.axisLine.size,t.beginPath(),t.moveTo(this.viewPortHandler.contentLeft(),this.viewPortHandler.contentBottom()),t.lineTo(this.viewPortHandler.contentRight(),this.viewPortHandler.contentBottom()),t.stroke(),t.closePath())}drawAxisLabels(t){if(!this.xAxis.display||!this.xAxis.tickText.display)return;t.font=2*this.xAxis.tickText.size+"px Arial",t.textAlign="center",t.fillStyle=this.xAxis.tickText.color||this.xAxis.color;let i=this.pointValuesToPixel(),e=2*this.xAxis.tickText.size,a=this.viewPortHandler.contentBottom()+2*this.xAxis.tickText.margin+e;this.display&&this.xAxis.tickLine.display&&(a+=2*this.xAxis.tickLine.size);let s=this.xAxis.tickText.valueFormatter;for(let o=0;o<i.length;o+=2){let e=i[o];if(this.viewPortHandler.isInBoundsX(e)){let i=this.dataBounds.dataList[parseInt(this.values[o/2])],r=i.timestamp,n=h.formatDate(r);s&&(n=s(i)),t.fillText(n,e,a)}}}drawSeparatorLines(t){if(!this.xAxis.display||!this.xAxis.separatorLine.display)return;t.strokeStyle=this.xAxis.separatorLine.color||this.xAxis.color,t.lineWidth=this.xAxis.separatorLine.size,this.xAxis.separatorLine.style===c.DASH&&t.setLineDash(this.xAxis.separatorLine.dashValue);let i=this.pointValuesToPixel();for(let e=0;e<i.length;e+=2){let a=i[e];this.viewPortHandler.isInBoundsX(a)&&(t.beginPath(),t.moveTo(a,this.viewPortHandler.contentTop()),t.lineTo(a,this.viewPortHandler.contentBottom()),t.stroke(),t.closePath())}t.setLineDash([])}drawTickLines(t){if(!this.xAxis.display||!this.xAxis.tickLine.display)return;t.lineWidth=1,t.strokeStyle=this.xAxis.axisLine.color||this.xAxis.color;let i=this.pointValuesToPixel(),e=this.viewPortHandler.contentBottom(),a=e+2*this.xAxis.tickLine.size;for(let s=0;s<i.length;s+=2){let o=i[s];this.viewPortHandler.isInBoundsX(o)&&(t.beginPath(),t.moveTo(o,e),t.lineTo(o,a),t.stroke(),t.closePath())}}pointValuesToPixel(){let t=[];for(let i=0;i<2*this.valueCount;i+=2){let e=this.values[i/2];t[i]=(e-this.dataBounds.min)*this.dataBounds.dataSpace+this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate)/2}return t}computeAxis(){let t=this.dataBounds.min,i=Math.min(t+this.dataBounds.range-1,this.dataBounds.dataList.length-1);this.computeAxisValues(t,i)}};const k={ALWAYS:"always",FOLLOW_CROSS:"follow_cross",NONE:"none"};var P=class{constructor(){this.textSize=12,this.crossLine={style:c.SOLID,dashValue:[8,8],size:1,color:"#505050",text:{color:"#EDEDED",size:12,rectStrokeLineSize:1,rectStrokeLineColor:"#EDEDED",rectFillColor:"#505050",margin:4,valueFormatter:null}},this.generalData={labels:["\u65f6\u95f4","\u5f00","\u6536","\u9ad8","\u4f4e"],values:null,valueFormatter:null,text:{size:12,color:"#898989",margin:20}},this.indicatorData={displayRule:k.ALWAYS,valueFormatter:null,text:{size:12,margin:20}}}};var f=class extends o{constructor(t,i,e,a,s,o,r,h,n){super(h,n),this.displayCross=!1,this.crossPoint={x:0,y:0},this.tooltip=t,this.candle=i,this.indicator=e,this.yAxis=a,this.candleChart=s,this.volChart=o,this.indicatorChart=r,this.yAxisLabelStrokePathPoints=[]}draw(t){if(this.dataBounds.currentDataPos<this.dataBounds.dataList.length){let i=this.dataBounds.dataList[this.dataBounds.currentDataPos];if(this.displayCross&&(this.crossPoint.x=this.viewPortHandler.contentLeft()+this.dataBounds.dataSpace*(this.dataBounds.currentDataPos-this.dataBounds.min)+this.dataBounds.dataSpace*(1-this.dataBounds.dataMarginSpaceRate)/2,t.font=2*(this.tooltip.crossLine.text.size||this.tooltip.textSize)+"px Arial",this.drawCrossHorizontalLine(t),this.drawCrossVerticalLine(t,i)),this.tooltip.indicatorData.displayRule===k.ALWAYS||this.tooltip.indicatorData.displayRule===k.FOLLOW_CROSS&&this.displayCross){let e=2*(this.tooltip.indicatorData.text.size||this.tooltip.textSize),a=this.viewPortHandler.contentLeft()+10;t.font=e+"px Arial",this.drawGeneralDataTooltip(t,a,i),this.candle.chartStyle!==M.TIME_LINE&&this.drawIndicatorTooltip(t,a,this.candleChart.chartTop+10+e+10+2*(this.tooltip.generalData.text.size||this.tooltip.textSize),i,this.candleChart.indicatorType),this.drawIndicatorTooltip(t,a,this.volChart.chartTop+4+e,i,this.volChart.indicatorType),this.drawIndicatorTooltip(t,a,this.indicatorChart.chartTop+4+e,i,this.indicatorChart.indicatorType)}}}drawCrossHorizontalLine(t){let i=this.getCrossYAxisLabel();if(null==i)return;let e,a=this.yAxis.tickText.position===u.OUTSIDE,s=this.tooltip.crossLine.text.size||this.tooltip.textSize,o=h.calcTextWidth(2*s+"px Arial",i),r=s,n=this.crossPoint.y+r,l=this.viewPortHandler.contentLeft(),d=this.viewPortHandler.contentRight(),x=this.viewPortHandler.getContentCenter(),g=this.tooltip.crossLine.text.margin,L=this.tooltip.crossLine.text.rectStrokeLineSize;a?e=this.yAxis.yAxisPosition===m.LEFT?l-L-2*g-o:d+L+2*g:this.crossPoint.x>x.x?(l=this.viewPortHandler.contentLeft()+2*L+3*g+o,e=this.viewPortHandler.contentLeft()+L+g):e=(d=this.viewPortHandler.contentRight()-2*L-3*g-o)+L+2*g,!a&&this.crossPoint.x>x.x||a&&this.yAxis.yAxisPosition===m.LEFT?(this.yAxisLabelStrokePathPoints[0]={x:l,y:this.crossPoint.y},this.yAxisLabelStrokePathPoints[1]={x:l-g,y:this.crossPoint.y-r-g},this.yAxisLabelStrokePathPoints[2]={x:l-3*g-o,y:this.yAxisLabelStrokePathPoints[1].y},this.yAxisLabelStrokePathPoints[3]={x:this.yAxisLabelStrokePathPoints[2].x,y:this.crossPoint.y+r+g},this.yAxisLabelStrokePathPoints[4]={x:this.yAxisLabelStrokePathPoints[1].x,y:this.yAxisLabelStrokePathPoints[3].y}):(this.yAxisLabelStrokePathPoints[0]={x:d,y:this.crossPoint.y},this.yAxisLabelStrokePathPoints[1]={x:d+g,y:this.crossPoint.y-r-g},this.yAxisLabelStrokePathPoints[2]={x:d+3*g+o,y:this.yAxisLabelStrokePathPoints[1].y},this.yAxisLabelStrokePathPoints[3]={x:this.yAxisLabelStrokePathPoints[2].x,y:this.crossPoint.y+r+g},this.yAxisLabelStrokePathPoints[4]={x:this.yAxisLabelStrokePathPoints[1].x,y:this.yAxisLabelStrokePathPoints[3].y}),t.lineWidth=this.tooltip.crossLine.size,t.strokeStyle=this.tooltip.crossLine.color,this.tooltip.crossLine.style===c.DASH&&t.setLineDash(this.tooltip.crossLine.dashValue),t.beginPath(),t.moveTo(l,this.crossPoint.y),t.lineTo(d,this.crossPoint.y),t.stroke(),t.closePath(),t.setLineDash([]),t.fillStyle=this.tooltip.crossLine.rectFillColor,t.beginPath(),t.moveTo(this.yAxisLabelStrokePathPoints[0].x,this.yAxisLabelStrokePathPoints[0].y);for(let h=1;h<this.yAxisLabelStrokePathPoints.length;h++)t.lineTo(this.yAxisLabelStrokePathPoints[h].x,this.yAxisLabelStrokePathPoints[h].y);t.closePath(),t.fill(),t.lineWidth=this.tooltip.crossLine.rectStrokeLineSize,t.strokeStyle=this.tooltip.crossLine.rectStrokeLineColor,t.beginPath(),t.moveTo(this.yAxisLabelStrokePathPoints[0].x,this.yAxisLabelStrokePathPoints[0].y);for(let h=1;h<this.yAxisLabelStrokePathPoints.length;h++)t.lineTo(this.yAxisLabelStrokePathPoints[h].x,this.yAxisLabelStrokePathPoints[h].y);t.closePath(),t.stroke(),t.fillStyle=this.tooltip.crossLine.text.color,t.fillText(i,e,n)}getCrossYAxisLabel(){let t=this.candleChart.yAxisChart,i=t.chartHeight,e=t.chartTop,a=this.volChart.yAxisChart,s=a.chartHeight,o=a.chartTop,r=this.indicatorChart.yAxisChart,h=r.chartHeight,n=r.chartTop,d=this.crossPoint.y;if(d>e&&d<i+e){let a=t.axisMinimum,s=(1-(d-e)/i)*(t.axisMaximum-a)+a,o=s.toFixed(2);return this.tooltip.crossLine.text.valueFormatter&&(o=this.tooltip.crossLine.text.valueFormatter("y",s)||"--"),o}if(d>o&&d<o+s){let t=a.axisMinimum,i=(1-(d-o)/s)*(a.axisMaximum-t)+t,e=i.toFixed(0);return this.tooltip.crossLine.text.valueFormatter&&(e=this.tooltip.crossLine.text.valueFormatter("y",i)||"--"),e}if(d>n&&d<n+h){let t=r.axisMinimum,i=(1-(d-n)/h)*(r.axisMaximum-t)+t,e=i.toFixed(2);return this.indicatorChart.indicatorType===l.VOL&&(e=i.toFixed(0)),this.tooltip.crossLine.text.valueFormatter&&(e=this.tooltip.crossLine.text.valueFormatter("y",i)||"--"),e}return null}drawCrossVerticalLine(t,i){t.lineWidth=this.tooltip.crossLine.size,t.strokeStyle=this.tooltip.crossLine.color,this.tooltip.crossLine.style===c.DASH&&t.setLineDash(this.tooltip.crossLine.dashValue),t.beginPath(),t.moveTo(this.crossPoint.x,this.viewPortHandler.contentTop()),t.lineTo(this.crossPoint.x,this.viewPortHandler.contentBottom()),t.stroke(),t.closePath(),t.setLineDash([]);let e=i.timestamp,a=h.formatDate(e);this.tooltip.crossLine.text.valueFormatter&&(a=this.tooltip.crossLine.text.valueFormatter("x",i)||"--");let s=this.tooltip.crossLine.text.size||this.tooltip.textSize,o=h.calcTextWidth(2*s+"px Arial",a),r=this.crossPoint.x-o/2,n=this.tooltip.crossLine.text.margin,l=this.tooltip.crossLine.text.rectStrokeLineSize;r<this.viewPortHandler.contentLeft()+n+l?r=this.viewPortHandler.contentLeft():r>this.viewPortHandler.contentRight()-o-l&&(r=this.viewPortHandler.contentRight()-o-l);let d=r-l-n,x=this.viewPortHandler.contentBottom(),m=r+o+n+l,u=this.viewPortHandler.contentBottom()+2*s+l+2*n;t.fillStyle=this.tooltip.crossLine.text.rectFillColor,t.fillRect(d,x,m-d,u-x),t.lineWidth=l,t.strokeStyle=this.tooltip.crossLine.rectStrokeLineColor,t.strokeRect(d,x,m-d,u-x),t.fillStyle=this.tooltip.crossLine.text.color,t.fillText(a,r,this.viewPortHandler.contentBottom()+2*s+l+n)}drawGeneralDataTooltip(t,i,e){let a=this.tooltip.generalData.text.size||this.tooltip.textSize;t.font=2*a+"px Arial";let s=this.tooltip.generalData.text.color,o=[];if(this.tooltip.generalData.values)o=this.tooltip.generalData.values(e)||[];else{let t=this.tooltip.generalData.valueFormatter,i=h.formatDate(e.timestamp),a=e.open.toFixed(2),s=e.close.toFixed(2),r=e.high.toFixed(2),n=e.low.toFixed(2);t&&(i=t(0,e.timestamp)||"--",a=t(1,e.open)||"--",s=t(2,e.close)||"--",r=t(3,e.high)||"--",n=t(4,e.low)||"--"),o=[i,a,s,r,n]}let r=this.tooltip.generalData.labels;for(let n=0;n<r.length;n++){let e=(r[n]||"--")+": ",l=h.calcTextWidth(2*a+"px Arial",e);t.fillStyle=s,t.fillText(e,i,2*a+4),i+=l;let d,c=o[n]||"--";"object"===typeof c?(d=c.value||"--",t.fillStyle=c.color||s):(t.fillStyle=s,d=c);let x=h.calcTextWidth(2*a+"px Arial",d);t.fillText(d,i,2*a+4),i+=x+this.tooltip.generalData.text.margin}}drawIndicatorTooltip(t,i,e,a,s){switch(s){case l.MA:{let s=a.ma;this.drawIndicatorTooltipLabels(t,i,e,[s.ma5,s.ma10,s.ma20,s.ma60],["MA5","MA10","MA20","MA60"],a,l.MA);break}case l.MACD:{let s=a.macd;this.drawIndicatorTooltipLabels(t,i,e,[s.diff,s.dea,s.macd],["DIFF","DEA","MACD"],a,l.MACD);break}case l.VOL:{let s=a.vol;this.drawIndicatorTooltipLabels(t,i,e,[s.ma5,s.ma10,s.ma20,s.num],["MA5","MA10","MA20","VOLUME"],a,l.VOL);break}case l.BOLL:{let s=a.boll;this.drawIndicatorTooltipLabels(t,i,e,[s.up,s.mid,s.dn],["UP","MID","DN"],a,l.BOLL);break}case l.BIAS:{let s=a.bias;this.drawIndicatorTooltipLabels(t,i,e,[s.bias1,s.bias2,s.bias3],["BIAS6","BIAS12","BIAS24"],a,l.BIAS);break}case l.BRAR:{let s=a.brar;this.drawIndicatorTooltipLabels(t,i,e,[s.br,s.ar],["BR","AR"],a,l.BRAR);break}case l.CCI:{let s=a.cci;this.drawIndicatorTooltipLabels(t,i,e,[s.cci],["CCI"],a,l.CCI);break}case l.CR:{let s=a.cr;this.drawIndicatorTooltipLabels(t,i,e,[s.cr,s.ma1,s.ma2,s.ma3,s.ma4],["CR","MA1","MA2","MA3","MA4"],a,l.CR);break}case l.DMA:{let s=a.dma;this.drawIndicatorTooltipLabels(t,i,e,[s.dif,s.difMa],["DIF","DIFMA"],a,l.DMA);break}case l.DMI:{let s=a.dmi;this.drawIndicatorTooltipLabels(t,i,e,[s.mdi,s.pdi,s.adx,s.adxr],["MDI","PDI","ADX","ADXR"],a,l.DMI);break}case l.KDJ:{let s=a.kdj;this.drawIndicatorTooltipLabels(t,i,e,[s.k,s.d,s.j],["K","D","J"],a,l.KDJ);break}case l.KD:{let s=a.kdj;this.drawIndicatorTooltipLabels(t,i,e,[s.k,s.d],["K","D"],a,l.KDJ);break}case l.RSI:{let s=a.rsi;this.drawIndicatorTooltipLabels(t,i,e,[s.rsi1,s.rsi2,s.rsi3],["RSI6","RSI12","RSI24"],a,l.RSI);break}case l.PSY:{let s=a.psy;this.drawIndicatorTooltipLabels(t,i,e,[s.psy],["PSY"],a,l.PSY);break}case l.TRIX:{let s=a.trix;this.drawIndicatorTooltipLabels(t,i,e,[s.trix,s.maTrix],["TRIX","MATRIX"],a,l.TRIX);break}case l.OBV:{let s=a.obv;this.drawIndicatorTooltipLabels(t,i,e,[s.obv,s.maObv],["OBV","MAOBV"],a,l.OBV);break}case l.VR:{let s=a.vr;this.drawIndicatorTooltipLabels(t,i,e,[s.vr,s.maVr],["VR","MAVR"],a,l.VR);break}case l.WR:{let s=a.wr;this.drawIndicatorTooltipLabels(t,i,e,[s.wr1,s.wr2,s.wr3],["WR1","WR2","WR3"],a,l.WR);break}case l.MTM:{let s=a.mtm;this.drawIndicatorTooltipLabels(t,i,e,[s.mtm,s.mtmMa],["MTM","MTMMA"],a,l.MTM);break}case l.EMV:{let s=a.emv;this.drawIndicatorTooltipLabels(t,i,e,[s.emv,s.maEmv],["EMV","MAEMV"],a,l.EMV);break}case l.SAR:{let s=a.sar;this.drawIndicatorTooltipLabels(t,i,e,[s.sar],["SAR"],a,l.SAR);break}}}drawIndicatorTooltipLabels(t,i,e,a,s,o,r){let n=i;for(let d=0;d<a.length;d++){let i=a[d],o="--";(i||0===i)&&(o=r===l.VOL?i.toFixed(0):i.toFixed(2)),this.tooltip.indicatorData.valueFormatter&&(o=this.tooltip.indicatorData.valueFormatter(r,i)||"--");let c=s[d]+": "+o,x=h.calcTextWidth(2*(this.tooltip.indicatorData.text.size||this.tooltip.textSize)+"px Arial",c);t.fillStyle=this.indicator.lineColors[d],t.fillText(c,n,e),n+=this.tooltip.indicatorData.text.margin+x}}setCross(t,i){this.crossPoint.y=t,this.displayCross=i}};var b=class extends x{constructor(){super(),this.xAxisMaxHeight=20,this.xAxisMinHeight=20}getRequiredHeightSpace(){let t=2*this.tickText.size+2*this.tickText.margin;this.display&&this.tickLine.display&&(t+=2*this.tickLine.size),this.display&&this.axisLine.display&&(t+=this.axisLine.size);let i=t;return this.xAxisMaxHeight>0&&(i=2*this.xAxisMaxHeight),t=Math.max(2*this.xAxisMinHeight,Math.min(t,i))}};var T=class{constructor(){this.display=!0,this.lineSize=1,this.lineColor="#707070"}};const S="cross",C="drag";var B=class{constructor(t,i,e){this.kline=t,this.dataBounds=i,this.viewPortHandler=e,this.eventMode=S,this.mouseDownPoint={x:0,y:0}}mouseDown(t){let i=this.getCanvasPoint(t);this.isValidEvent(i)&&(this.eventMode=C,this.mouseDownPoint.x=t.x,this.mouseDownPoint.y=t.y,this.kline.tooltipChart.setCross(i.y,!1),this.kline.freshen())}mouseUp(t){let i=this.getCanvasPoint(t);this.isValidEvent(i)&&(this.eventMode=S,this.kline.tooltipChart.setCross(i.y,!0),this.kline.freshen())}mouseLeave(t){let i=this.getCanvasPoint(t);this.kline.tooltipChart.setCross(i.y,!1),this.kline.freshen()}mouseMove(t){let i=this.getCanvasPoint(t);if(!this.isValidEvent(i))return this.kline.tooltipChart.setCross(i.y,!1),void this.kline.freshen();if(this.eventMode===C){let i=t.x-this.mouseDownPoint.x;if(i>this.dataBounds.dataSpace/2){if(0===this.dataBounds.min||this.dataBounds.dataList.length<this.dataBounds.range)return!1;this.mouseDownPoint.x=t.x;let e=+Math.abs(i/this.dataBounds.dataSpace).toFixed(0);0===e&&(e=1),this.dataBounds.min-=e,this.dataBounds.min<=0&&(this.dataBounds.min=0),this.kline.freshen()}else if(i<0-this.dataBounds.dataSpace/2){if(this.dataBounds.min+this.dataBounds.range===this.dataBounds.dataList.length||this.dataBounds.dataList.length<this.dataBounds.range)return!1;this.mouseDownPoint.x=t.x;let e=+Math.abs(i/this.dataBounds.dataSpace).toFixed(0);0===e&&(e=1),this.dataBounds.min+=e,this.dataBounds.min>=this.dataBounds.dataList.length-this.dataBounds.range&&(this.dataBounds.min=this.dataBounds.dataList.length-this.dataBounds.range),this.kline.freshen()}}else this.eventMode===S&&(this.dataBounds.calcCurrentDataIndex(i.x),this.kline.tooltipChart.setCross(i.y,!0),this.kline.freshen())}mouseWheel(t){let i=this.dataBounds.min,e=this.dataBounds.range,a=1;if(1===Math.max(-1,Math.min(1,t.wheelDelta||-t.detail))){if(a=.95,this.dataBounds.range>=this.dataBounds.maxRange)return!1}else if(a=1.05,this.dataBounds.range<=this.dataBounds.minRange)return!1;this.dataBounds.range=+(e/a).toFixed(0),this.dataBounds.range=Math.min(Math.max(this.dataBounds.range,this.dataBounds.minRange),this.dataBounds.maxRange),this.dataBounds.min=i+e-this.dataBounds.range,this.dataBounds.min+this.dataBounds.range>this.dataBounds.dataList.length&&(this.dataBounds.min=0),this.dataBounds.min<0&&(this.dataBounds.min=0),this.kline.freshen()}isValidEvent(t){return!(t.x<this.viewPortHandler.contentLeft()||t.x>this.viewPortHandler.contentRight()||t.y<this.viewPortHandler.contentTop()||t.y>this.viewPortHandler.contentBottom())}getCanvasPoint(t){let i=this.kline.canvasDom.getBoundingClientRect();return{x:2*Math.round(t.clientX-i.left),y:2*Math.round(t.clientY-i.top)}}};function D(t){let i,e,a,s,o,r=0,h=0;for(let n=0;n<t.length;n++){r+=t[n].turnover,0!==(h+=t[n].volume)&&(t[n].averagePrice=r/h);let l=t[n].close;n<8?(s=I(t.slice(0,n+1)),o=R(t.slice(0,n+1))):(s=I(t.slice(n-8,n+1)),o=R(t.slice(n-8,n+1)));let d=(l-s)/(o-s===0?1:o-s)*100;a=3*(i=2/3*(n<8?50:t[n-1].kdj.k)+1/3*d)-2*(e=2/3*(n<8?50:t[n-1].kdj.d)+1/3*i),t[n].kdj={k:i,d:e,j:a}}return t}function H(t,i){let e=0;for(let o=0;o<t.length;o++){let a=t[o].close-i;e+=a*a}let a=e>0;e=Math.abs(e);let s=Math.sqrt(e/t.length);return a?s:-1*s}function R(t){let i=0;if(t&&t.length>0){let e=t.length;i=t[0].high;for(let a=1;a<e;a++)i=Math.max(t[a].high,i)}return i}function I(t){let i=0;if(t&&t.length>0){let e=t.length;i=t[0].low;for(let a=1;a<e;a++)i=Math.min(t[a].low,i)}return i}var V=class{constructor(t){this.rootDom=t,this.domWidth=0,this.domHeight=0,this.canvas=null,this.canvasDom=null,this.viewPortHandler=new a,this.dataBounds=new s(this.viewPortHandler),this.grid=new T,this.yAxis=new g,this.xAxis=new b,this.candle=new y,this.indicator=new d,this.tooltip=new P,this.gridChart=new r(this.grid,this.dataBounds,this.viewPortHandler),this.candleChart=new A(this.candle,this.indicator,this.yAxis,this.dataBounds,this.viewPortHandler),this.volChart=new p(this.indicator,this.xAxis,this.yAxis,this.dataBounds,this.viewPortHandler,l.VOL),this.indicatorChart=new p(this.indicator,this.xAxis,this.yAxis,this.dataBounds,this.viewPortHandler),this.xAxisChart=new w(this.xAxis,this.dataBounds,this.viewPortHandler),this.tooltipChart=new f(this.tooltip,this.candle,this.indicator,this.yAxis,this.candleChart,this.volChart,this.indicatorChart,this.dataBounds,this.viewPortHandler),this.motionEvent=new B(this,this.dataBounds,this.viewPortHandler),this.isShouldCalcOffset=!0,this.isShouldCalcChartHeight=!0,this.init()}init(){this.canvasDom=document.createElement("canvas"),this.canvasDom.addEventListener("mousedown",t=>{this.motionEvent.mouseDown(t)}),this.canvasDom.addEventListener("mouseup",t=>{this.motionEvent.mouseUp(t)}),this.canvasDom.addEventListener("mousemove",t=>{this.motionEvent.mouseMove(t)}),this.canvasDom.addEventListener("mouseleave",t=>{this.motionEvent.mouseLeave(t)}),this.canvasDom.addEventListener("mousewheel",t=>{this.motionEvent.mouseWheel(t)},!1),this.canvasDom.addEventListener("DOMMouseScroll",t=>{this.motionEvent.mouseWheel(t)},!1),this.rootDom.appendChild(this.canvasDom),this.resize()}resize(){this.isShouldCalcOffset=!0,this.domWidth=2*this.rootDom.offsetWidth,this.domHeight=2*this.rootDom.offsetHeight,this.canvasDom.style.width=this.rootDom.offsetWidth+"px",this.canvasDom.style.height=this.rootDom.offsetHeight+"px",this.freshen()}setConfig(t){if(t){let i=t.common;i&&(i.minVisibleRange>0&&(this.dataBounds.minRange=i.minVisibleRange),i.maxVisibleRange>0&&i.maxVisibleRange>this.dataBounds.minRange&&(this.dataBounds.maxRange=i.maxVisibleRange),i.defaultVisibleRange>0&&i.defaultVisibleRange>this.dataBounds.minRange-1&&i.defaultVisibleRange<this.dataBounds.maxRange+1&&(this.dataBounds.range=i.defaultVisibleRange));let e=t.grid;e&&(this.grid.display=e.display,e.lineSize>0&&(this.grid.lineSize=e.lineSize),e.lineColor&&(this.grid.lineColor=e.lineColor));let a=i.candle;a&&(a.chartType&&(this.candle.chartStyle=a.chartType),a.timeChart&&(this.candle.timeChart={...this.candle.timeChart,...a.timeChart}),a.candleChart&&(this.candle.candleChart={...this.candle.candleChart,...a.candleChart}),a.lowestHighestPriceMarkTextColor&&(this.candle.lowestHighestPriceMarkTextColor=a.lowestHighestPriceMarkTextColor),a.lowestHighestPriceMarkTextSize>0&&(this.candle.lowestHighestPriceMarkTextSize=a.lowestHighestPriceMarkTextSize),this.candle.lowestHighestValueFormatter=a.lowestHighestValueFormatter,a.highestPriceMark&&(this.candle.highestPriceMark={...this.candle.highestPriceMark,...a.highestPriceMark}),a.lowestPriceMark&&(this.candle.lowestPriceMark={...this.candle.lowestPriceMark,...a.lowestPriceMark}),a.lastPriceMark&&(this.candle.lastPriceMark={...this.candle.lastPriceMark,...a.lastPriceMark}));let s=t.indicator;s&&(s.lineSize>0&&(this.indicator.lineSize=s.lineSize),s.increasingColor&&(this.indicator.increasingColor=s.increasingColor),s.decreasingColor&&(this.indicator.decreasingColor=s.decreasingColor),s.lineColors&&s.lineColors.length>4&&(this.indicator.lineColors=s.lineColors));let o=t.xAxis;o&&(this.xAxis.display=o.display,this.xAxis.color&&(this.xAxis.color=o.color),o.minHeight>=0&&(this.xAxis.xAxisMinHeight=o.minHeight),o.maxHeight>=0&&o.maxHeight>=this.xAxis.xAxisMinHeight&&(this.xAxis.xAxisMaxHeight=o.maxHeight),o.axisLine&&(this.xAxis.axisLine={...this.xAxis.axisLine,...o.axisLine}),o.tickText&&(this.xAxis.tickText={...this.xAxis.tickText,...o.tickText}),o.tickLine&&(this.xAxis.tickLine={...this.xAxis.tickLine,...o.tickLine}),o.separatorLine&&(this.xAxis.separatorLine={...this.xAxis.separatorLine,...o.separatorLine}));let r=t.yAxis;r&&(this.yAxis.display=r.display,r.position&&(this.yAxis.yAxisPosition=r.position,this.isShouldCalcOffset=!0),this.yAxis.color&&(this.yAxis.color=r.color),r.minWidth>=0&&(this.yAxis.yAxisMinWidth=r.minWidth),r.maxWidth>=0&&r.maxWidth>=this.yAxis.yAxisMinWidth&&(this.yAxis.yAxisMaxWidth=r.maxWidth),r.axisLine&&(this.yAxis.axisLine={...this.yAxis.axisLine,...r.axisLine}),r.tickText&&(this.yAxis.tickText={...this.yAxis.tickText,...r.tickText},this.isShouldCalcOffset=!0),r.tickLine&&(this.yAxis.tickLine={...this.yAxis.tickLine,...r.tickLine}),r.separatorLine&&(this.yAxis.separatorLine={...this.yAxis.separatorLine,...r.separatorLine}));let h=t.tooltip;h&&(h.textSize>0&&(this.tooltip.textSize=h.textSize),h.crossLine&&(h.crossLine.text&&(h.crossLine.text={...this.tooltip.crossLine.text,...h.crossLine.text}),this.tooltip.crossLine={...this.tooltip.crossLine,...h.crossLine}),h.generalData&&(h.generalData.text&&(h.generalData.text={...this.tooltip.generalData.text,...h.generalData.text}),this.tooltip.generalData={...this.tooltip.generalData,...h.generalData}),h.indicatorData&&(h.indicatorData.text&&(h.indicatorData.text={...this.tooltip.indicatorData.text,...h.indicatorData.text}),this.tooltip.indicatorData={...this.tooltip.indicatorData,...h.indicatorData})),this.freshen()}}calcChartHeight(t){let i=this.xAxis.getRequiredHeightSpace(),e=t-i,a=this.isDisplayVolChart(),s=this.isDisplayIndicatorChart(),o=0,r=0;if(a&&s){let t=.2*e;o=t,r=t}else a&&!s?o=.3*e:!a&&s&&(r=.3*e);let h=e-o-r,n=0;this.candleChart.setChartDimens(h,n),n+=h,this.volChart.setChartDimens(o,n),n+=o,this.indicatorChart.setChartDimens(r,n),n+=r,this.xAxisChart.setChartDimens(i,n)}calcOffsets(){let t=0,i=0,e=0;if(this.yAxis.needsOffset()){let e=this.yAxis.getRequiredWidthSpace();this.yAxis.yAxisPosition===m.LEFT?t+=e:i+=e}e+=this.xAxis.getRequiredHeightSpace(),this.viewPortHandler.restrainViewPort(t,0,i,e)}freshen(){this.canvasDom.width=this.domWidth,this.canvasDom.height=this.domHeight,this.canvas=this.canvasDom.getContext("2d"),this.isShouldCalcChartHeight&&(this.calcChartHeight(this.domHeight),this.isShouldCalcChartHeight=!1),this.isShouldCalcOffset&&(this.viewPortHandler.setChartDimens(this.domWidth,this.domHeight),this.calcOffsets(),this.isShouldCalcOffset=!1),this.draw()}draw(){this.dataBounds.space(),this.gridChart.draw(this.canvas),this.xAxisChart.draw(this.canvas),this.candleChart.draw(this.canvas),this.volChart.draw(this.canvas),this.indicatorChart.draw(this.canvas),this.tooltipChart.draw(this.canvas)}calcIndicator(t){switch(t){case l.MA:this.dataBounds.dataList=function(t){let i,e,a,s,o=0,r=0,h=0,n=0,l=0,d=0;for(let c=0;c<t.length;c++){d+=t[c].volume,l+=t[c].turnover||0,0!==d&&(t[c].averagePrice=l/d);let x=t[c].close;o+=x,r+=x,h+=x,n+=x,i=c<5?o/(c+1):(o-=t[c-5].close)/5,e=c<10?r/(c+1):(r-=t[c-10].close)/10,a=c<20?h/(c+1):(h-=t[c-20].close)/20,s=c<60?n/(c+1):(n-=t[c-60].close)/60,t[c].ma={ma5:i,ma10:e,ma20:a,ma60:s}}return t}(this.dataBounds.dataList);break;case l.MACD:this.dataBounds.dataList=function(t){let i,e,a=0,s=0,o=0,r=0,h=0,n=0,l=0,d=0;for(let c=0;c<t.length;c++){l+=t[c].turnover,0!==(d+=t[c].volume)&&(t[c].averagePrice=l/d);let x=t[c].close;c>0&&(n=2*((o=(i=(2*x+11*a)/13)-(e=(2*x+25*s)/27))-(r=(2*o+8*h)/10)),a=i,s=e,h=r),t[c].macd={diff:o,dea:r,macd:n}}return t}(this.dataBounds.dataList);break;case l.VOL:this.dataBounds.dataList=function(t){let i,e,a,s=0,o=0,r=0,h=0,n=0;for(let l=0;l<t.length;l++){h+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=h/n);let d=t[l].volume;s+=d,o+=d,r+=d,i=l<5?s/(l+1):(s-=t[l-5].volume)/5,e=l<10?o/(l+1):(o-=t[l-10].volume)/10,a=l<20?r/(l+1):(r-=t[l-20].volume)/20,t[l].vol={num:d,ma5:i,ma10:e,ma20:a}}return t}(this.dataBounds.dataList);break;case l.BOLL:this.dataBounds.dataList=function(t){let i,e,a,s,o,r=0,h=0,n=0,l=0;for(let d=0;d<t.length;d++){n+=t[d].turnover,0!==(l+=t[d].volume)&&(t[d].averagePrice=n/l);let c=t[d].close;r+=c,h+=c,d>=24?(e=h/25,h-=t[d-24].close):e=h/(d+1),d>=25?(i=r/26,a=H(t.slice(d-25,d+1),i),r-=t[d-25].close):(i=r/(d+1),a=H(t.slice(0,d+1),i)),s=e+2*a,o=e-2*a,t[d].boll={up:s,mid:i,dn:o}}return t}(this.dataBounds.dataList);break;case l.BIAS:this.dataBounds.dataList=function(t){let i,e,a,s=0,o=0,r=0,h=0,n=0;for(let l=0;l<t.length;l++){h+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=h/n);let d=t[l].close;if(s+=d,o+=d,r+=d,l<6){let t=s/(l+1);i=(d-t)/t*100}else{let e=(s-=t[l-6].close)/6;i=(d-e)/e*100}if(l<12){let t=o/(l+1);e=(d-t)/t*100}else{let i=(o-=t[l-12].close)/12;e=(d-i)/i*100}if(l<24){let t=r/(l+1);a=(d-t)/t*100}else{let i=(r-=t[l-24].close)/24;a=(d-i)/i*100}t[l].bias={bias1:i,bias2:e,bias3:a}}return t}(this.dataBounds.dataList);break;case l.BRAR:this.dataBounds.dataList=function(t){let i=0,e=0,a=0,s=0,o=0,r=0,h=0,n=0;for(let l=0;l<t.length;l++){h+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=h/n);let d=t[l].high,c=t[l].low,x=t[l].open;if(o+=d-x,r+=x-c,l>25&&(o-=t[l-26].high-t[l-26].open,r-=t[l-26].open-t[l-26].low),0!==r&&(e=o/r*100),l>0){let e=t[l-1].close,o=d-e;o<0&&(o=0),a+=o;let r=e-c;r<0&&(r=0),0!==(s+=r)&&(i=a/s*100)}t[l].brar={br:i,ar:e}}return t}(this.dataBounds.dataList);break;case l.CCI:this.dataBounds.dataList=function(t){let i,e=0,a=0,s=0;for(let o=0;o<t.length;o++){a+=t[o].turnover,0!==(s+=t[o].volume)&&(t[o].averagePrice=a/s);let r=(t[o].high+t[o].low+t[o].close)/3;if(e+=r,o>=13){let a=e/14;e-=(t[o-13].high+t[o-13].low+t[o-13].close)/3;let s=0;for(let i=o-13;i<o+1;i++){let e=(t[i].high+t[i].low+t[i].close)/3;s+=Math.abs(e-a)}let h=s/14;i=0===h?0:200*(r-a)/3/h}else{let a=e/(o+1),s=0;for(let i=0;i<o+1;i++){let e=(t[i].high+t[i].low+t[i].close)/3;s+=Math.abs(e-a)}let h=s/(o+1);i=0===h?0:200*(r-a)/3/h}t[o].cci={cci:i}}return t}(this.dataBounds.dataList);break;case l.CR:this.dataBounds.dataList=function(t){let i,e,a,s,o,r,h,n,l=0,d=0,c=0,x=0,m=[],u=0,g=[],L=0,p=[],v=0,M=[],y=0,A=0;for(let w=0;w<t.length;w++){if(y+=t[w].turnover,0!==(A+=t[w].volume)&&(t[w].averagePrice=y/A),w>0){let i=t[w-1].high,e=t[w-1].low,a=(i+t[w-1].close+e+t[w-1].open)/4,s=t[w].high,o=t[w].low,r=s-a;r<0&&(r=0),d+=r;let h=a-o;if(h<0&&(h=0),c+=h,w>26){let i=(t[w-27].high+t[w-27].low+t[w-27].close+t[w-27].open)/4,e=t[w-26].high,a=t[w-26].low,s=e-i;s<0&&(s=0);let o=i-a;o<0&&(o=0),d-=s,c-=o}0!==c&&(l=d/c*100);let n=(t[w-1].high+t[w-1].low+t[w-1].close)/3,x=t[w].high-n;d+=x<=0?0:x;let m=n-t[w].low;c+=m<=0?0:m}x+=l,u+=l,L+=l,v+=l,o=w<10?x/(w+1):(x-=t[w-10].cr.cr)/10,m.push(o),r=w<20?u/(w+1):(u-=t[w-20].cr.cr)/20,g.push(r),h=w<40?L/(w+1):(L-=t[w-40].cr.cr)/40,p.push(h),n=w<60?v/(w+1):(v-=t[w-60].cr.cr)/60,M.push(n),i=w<5?m.get(0):m[w-5],e=w<9?g.get(0):g[w-9],a=w<17?p.get(0):p[w-17],s=w<25?M.get(0):M[w-25],t[w].cr={cr:l,ma1:i,ma2:e,ma3:a,ma4:s}}return t}(this.dataBounds.dataList);break;case l.DMA:this.dataBounds.dataList=function(t){let i,e,a,s,o=0,r=0,h=0,n=0,l=0;for(let d=0;d<t.length;d++){n+=t[d].turnover,0!==(l+=t[d].volume)&&(t[d].averagePrice=n/l);let c=t[d].close;o+=c,r+=c,h+=i=(a=d<10?o/(d+1):(o-=t[d-10].close)/10)-(s=d<50?r/(d+1):(r-=t.get[d-50].close)/50),e=d<10?h/(d+1):(h-=t[d-10].dma.dif)/10,t[d].dma={dif:i,difMa:e}}return t}(this.dataBounds.dataList);break;case l.DMI:this.dataBounds.dataList=function(t){let i,e,a,s=0,o=0,r=0,h=0,n=[],l=[],d=[],c=[],x=[],m=0,u=0;for(let g=0;g<t.length;g++){if(m+=t[g].turnover,0!==(u+=t[g].volume)&&(t[g].averagePrice=m/u),g>0){a=t[g-1].close,i=t[g].high-t[g-1].high,e=t[g-1].low-t[g].low;let m,u,L=t[g].high-t[g].low>Math.abs(t[g].high-a)?t[g].high-t[g].low:Math.abs(t[g].high-a),p=L>Math.abs(a)-t[g].low?L:Math.abs(a)-t[g].low;n.push(p),m=i>0&&i>e?i:0,l.push(m),u=e>0&&e>i?e:0,d.push(u);let v=0,M=0,y=0;for(let t=0;t<n.length;t++)v+=n[t],M+=l[t],y+=d[t];s=100*M/v,o=100*y/v;let A=Math.abs(o-s)/(o+s)*100;c.push(A);let w=0;for(let t=0;t<c.length;t++)w+=c[t];r=w/6,x.push(r);let k=0;k+=x[0],h=(k+=x[x.length-1])/2,g>=14&&(n.remove(0),l.remove(0),d.remove(0)),g>=19&&c.remove(0),g>=25&&x.remove(0)}t[g].dmi={pdi:s,mdi:o,adx:r,adxr:h}}return t}(this.dataBounds.dataList);break;case l.KDJ:case l.KD:this.dataBounds.dataList=D(this.dataBounds.dataList);break;case l.RSI:this.dataBounds.dataList=function(t){let i,e,a,s,o,r,h=0,n=0,l=0,d=0,c=0,x=0,m=0,u=0,g=0,L=0,p=0,v=0,M=0;for(let y=0;y<t.length;y++){if(v+=t[y].turnover,0!==(M+=t[y].volume)&&(t[y].averagePrice=v/M),y>0){let v=t[y].close-t[y-1].close;v>0?d+=v:c+=v;let M=v>0?v:0,A=Math.abs(v);y<6?(i=d/(y+1),e=(Math.abs(c)+d)/(y+1)):(i=(M+5*x)/6,e=(A+5*m)/6),x=i,m=e,h=i/e*100,y<12?(a=d/(y+1),s=(Math.abs(c)+d)/(y+1)):(a=(M+11*u)/12,s=(A+11*g)/12),u=a,g=s,n=a/s*100,y<24?(o=d/(y+1),r=(Math.abs(c)+d)/(y+1)):(o=(M+23*L)/24,r=(A+23*p)/24),L=o,p=r,l=o/r*100}t[y].rsi={rsi1:h,rsi2:n,rsi3:l}}return t}(this.dataBounds.dataList);break;case l.PSY:this.dataBounds.dataList=function(t){let i=0,e=0,a=0,s=0;for(let o=0;o<t.length;o++)a+=t[o].turnover,0!==(s+=t[o].volume)&&(t[o].averagePrice=a/s),o>0&&(e+=t[o].close-t[o-1].close>0?1:0,o>=12?(i=e/12*100,e-=t[o-11].close-t[o-12].close>0?1:0):i=e/o*100),t[o].psy={psy:i};return t}(this.dataBounds.dataList);break;case l.TRIX:this.dataBounds.dataList=function(t){let i,e,a,s,o=0,r=0,h=0,n=0,l=0,d=0,c=0,x=0,m=0,u=0;for(let g=0;g<t.length;g++){m+=t[g].turnover,0!==(u+=t[g].volume)&&(t[g].averagePrice=m/u);let L=t[g].close;h+=L,n=e=g<12?h/(g+1):(2*L+11*n)/13,l+=e,d=a=g<12?l/(g+1):(2*e+11*d)/13,c+=a,s=g<12?c/(g+1):(2*a+11*x)/13,0!==x&&(o=(s-x)/x*100),r+=o,x=s,g<20?i=r/(g+1):(i=r/20,r-=t[g-19].trix.trix),t[g].trix={trix:o,maTrix:i}}return t}(this.dataBounds.dataList);break;case l.OBV:this.dataBounds.dataList=function(t){let i,e=0,a=0,s=0;for(let o=0;o<t.length;o++){a+=t[o].turnover,0!==(s+=t[o].volume)&&(t[o].averagePrice=a/s);let r=t[o].close,h=t[o].high,n=h-r,l=t[o].volume*(r-t[o].low-n)/h;e+=l,i=o<30?e/(o+1):(e-=t[o-30].obv.obv)/30,t[o].obv={obv:l,maObv:i}}return t}(this.dataBounds.dataList);break;case l.VR:this.dataBounds.dataList=function(t){let i,e=0,a=0,s=0,o=0,r=0,h=0,n=0;for(let l=0;l<t.length;l++){if(h+=t[l].turnover,0!==(n+=t[l].volume)&&(t[l].averagePrice=h/n),l<24){let i=t[l].close,o=t[l].open,r=t[l].volume;i>o?e+=r:i<o?a+=r:s+=r}else for(let i=l-24;i<l;i++){let o=t[i].close,r=t[i].open,h=t[i].volume;i===l-24&&(e=0,a=0,s=0),o>r?e+=h:o<r?a+=h:s+=h}let d=a+.5*s;0!==d&&(o=(e+.5*s)/d*100),r+=o,i=l<30?r/(l+1):(r-=t[l-30].vr.vr)/30,t[l].vr={vr:o,maVr:i}}return t}(this.dataBounds.dataList);break;case l.WR:this.dataBounds.dataList=function(t){let i=0,e=0,a=0,s=Number.MIN_VALUE,o=Number.MAX_VALUE,r=Number.MIN_VALUE,h=Number.MAX_VALUE,n=Number.MIN_VALUE,l=Number.MAX_VALUE,d=0,c=0;for(let x=0;x<t.length;x++){d+=t[x].turnover,0!==(c+=t[x].volume)&&(t[x].averagePrice=d/c);let m=t[x].close;if(x<13){let d=t[x].high,c=t[x].low;s=Math.max(d,s),o=Math.min(c,o),r=Math.max(d,r),h=Math.min(c,h),n=Math.max(d,n),l=Math.min(c,l);let u=s-o;0!==u&&(i=(s-m)/u*100),e=i,a=i}else{for(let e=x-13;e<x;e++){e===x-13?(s=t[e].high,o=t[e].low):(s=Math.max(t[e].high,s),o=Math.min(t[e].low,o));let a=s-o;0!==a&&(i=(s-m)/a*100)}if(x<34){let i=t[x].high,s=t[x].low;r=Math.max(i,r),h=Math.min(s,h),n=Math.max(i,n),l=Math.min(s,l);let o=r-h;0!==o&&(e=(r-m)/o*100),a=e}else{for(let i=x-34;i<x;i++){i===x-34?(r=t[i].high,h=t[i].low):(r=Math.max(t[i].high,r),h=Math.min(t[i].low,h));let a=r-h;0!==a&&(e=(r-m)/a*100)}if(x<89){let i=t[x].high,e=t[x].low,s=(n=Math.max(i,n))-(l=Math.min(e,l));0!==s&&(a=(n-m)/s*100)}else for(let i=x-89;i<x;i++){i===x-89?(n=t[i].high,l=t[i].low):(n=Math.max(t[i].high,n),l=Math.min(t[i].low,l));let e=n-l;0!==e&&(a=(n-m)/e*100)}}}t[x].wr={wr1:i,wr2:e,wr3:a}}return t}(this.dataBounds.dataList);break;case l.MTM:this.dataBounds.dataList=function(t){let i,e,a=0,s=0,o=0;for(let r=0;r<t.length;r++){s+=t[r].turnover,0!==(o+=t[r].volume)&&(t[r].averagePrice=s/o);let h=t[r].close;a+=i=r<6?h-t[0].close:h-t[r-6].close,e=r<10?a/(r+1):(a-=t[r-10].mtm.mtm)/10,t[r].mtm={mtm:i,mtmMa:e}}return t}(this.dataBounds.dataList);break;case l.EMV:this.dataBounds.dataList=function(t){let i,e=0,a=0,s=0,o=[],r=0,h=0;for(let n=0;n<t.length;n++){let l=t[n].turnover;if(r+=l,0!==(h+=t[n].volume)&&(t[n].averagePrice=r/h),n>0){let i=t[n].high,e=t[n].low;s=((i+e)/2-(t[n-1].high+t[n-1].low)/2)*(i-e)/l}o.push(s),n<14?e+=s:e-=o[n-14],a+=e,i=n<9?a/(n+1):(a-=t[n-9].emv.emv)/9,t[n].emv={emv:e,maEmv:i}}return t}(this.dataBounds.dataList);break;case l.SAR:this.dataBounds.dataList=function(t){let i=0,e=-100,a=!1,s=0,o=0,r=0;for(let h=0;h<t.length;h++){o+=t[h].turnover,0!==(r+=t[h].volume)&&(t[h].averagePrice=o/r);let n=s,l=t[h].high,d=t[h].low;if(a){(-100===e||e<l)&&(e=l,i=Math.min(i+.02,2)),s=n+i*(e-n);let o=Math.min(t[Math.max(1,h)-1].low,d);s>t[h].low?(s=e,i=0,e=-100,a=!a):s>o&&(s=o)}else{(-100===e||e>d)&&(e=d,i=Math.min(i+.02,.2)),s=n+i*(e-n);let o=Math.max(t[Math.max(1,h)-1].high,l);s<t[h].high?(s=e,i=0,e=-100,a=!a):s<o&&(s=o)}t[h].sar={sar:s}}return t}(this.dataBounds.dataList)}}calcChartIndicator(){this.candleChart.isDisplayChart()&&this.calcIndicator(this.candleChart.indicatorType),this.isDisplayVolChart()&&this.calcIndicator(l.VOL),this.isDisplayIndicatorChart()&&this.calcIndicator(this.indicatorChart.indicatorType),this.freshen()}setDataList(t){this.dataBounds.dataList=t,this.dataBounds.moveToLast(),this.calcChartIndicator(),this.freshen()}setMainIndicatorType(t){this.candleChart.indicatorType!==t&&(this.candleChart.indicatorType=t,this.calcIndicator(t),this.freshen())}setSubIndicatorType(t){if(this.indicatorChart.indicatorType!==t){let i=this.isDisplayIndicatorChart()&&t===l.NO||!this.isDisplayIndicatorChart()&&t!==l.NO;this.indicatorChart.indicatorType=t,i&&(this.isShouldCalcChartHeight=!0),this.calcIndicator(t),this.freshen()}}setShowVolIndicatorChart(t){this.isDisplayVolChart()!==t&&(t?(this.volChart.indicatorType=l.VOL,this.calcIndicator(l.VOL)):this.volChart.indicatorType=l.NO,this.isShouldCalcChartHeight=!0,this.freshen())}isDisplayVolChart(){return this.volChart.isDisplayChart()}isDisplayIndicatorChart(){return this.indicatorChart.isDisplayChart()}};e.d(i,"LineStyle",function(){return c}),e.d(i,"ChartStyle",function(){return M}),e.d(i,"CandleStyle",function(){return v}),e.d(i,"IndicatorType",function(){return l}),e.d(i,"YAxisTextPosition",function(){return u}),e.d(i,"YAxisPosition",function(){return m}),e.d(i,"IndicatorDisplayRule",function(){return k});const O={init:t=>new V(t)};i.default=O}]);
//# sourceMappingURL=kline.min.js.map